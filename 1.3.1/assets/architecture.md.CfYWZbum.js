import{_ as l,C as c,o as r,c as p,a2 as o,b as d,w as t,a as i,E as n,a3 as s}from"./chunks/framework.-Q5tCgKN.js";const m=JSON.parse('{"title":"ErrorLens.ErrorHandling -- Architecture Guide","description":"","frontmatter":{},"headers":[],"relativePath":"architecture.md","filePath":"architecture.md"}'),A={name:"architecture.md"};function E(g,e,h,u,C,f){const a=c("Mermaid");return r(),p("div",null,[e[14]||(e[14]=o('<h1 id="errorlens-errorhandling-architecture-guide" tabindex="-1">ErrorLens.ErrorHandling -- Architecture Guide <a class="header-anchor" href="#errorlens-errorhandling-architecture-guide" aria-label="Permalink to &quot;ErrorLens.ErrorHandling -- Architecture Guide&quot;">​</a></h1><p>This document provides a comprehensive architectural overview of the <strong>ErrorLens.ErrorHandling</strong> library, a structured error handling framework for ASP.NET Core APIs. It covers the package structure, middleware pipeline, dependency injection graph, handler chain of responsibility, configuration system, and all cross-cutting concerns.</p><blockquote><p><strong>Version covered:</strong> 1.3.1 <strong>Target frameworks:</strong> .NET 6.0 through .NET 10.0 (multi-targeting) <strong>Language:</strong> C# 12</p></blockquote><hr><h2 id="table-of-contents" tabindex="-1">Table of Contents <a class="header-anchor" href="#table-of-contents" aria-label="Permalink to &quot;Table of Contents&quot;">​</a></h2><ol><li><a href="#1-package-structure">Package Structure</a></li><li><a href="#2-high-level-architecture">High-Level Architecture</a></li><li><a href="#3-error-handling-pipeline-flow">Error Handling Pipeline Flow</a></li><li><a href="#4-dependency-injection-registration">Dependency Injection Registration</a></li><li><a href="#5-handler-chain-of-responsibility">Handler Chain of Responsibility</a></li><li><a href="#6-configuration-architecture">Configuration Architecture</a></li><li><a href="#7-attribute-system-and-metadata-caching">Attribute System and Metadata Caching</a></li><li><a href="#8-serialization-and-response-writing">Serialization and Response Writing</a></li><li><a href="#9-problemdetails-generation-rfc-9457">ProblemDetails Generation (RFC 9457)</a></li><li><a href="#10-localization-architecture">Localization Architecture</a></li><li><a href="#11-telemetry-and-distributed-tracing">Telemetry and Distributed Tracing</a></li><li><a href="#12-rate-limiting-integration">Rate Limiting Integration</a></li><li><a href="#13-openapi--swagger-integration">OpenAPI / Swagger Integration</a></li><li><a href="#14-multi-targeting-strategy">Multi-Targeting Strategy</a></li><li><a href="#15-key-design-decisions">Key Design Decisions</a></li><li><a href="#16-public-interface-catalog">Public Interface Catalog</a></li></ol><hr><h2 id="_1-package-structure" tabindex="-1">1. Package Structure <a class="header-anchor" href="#_1-package-structure" aria-label="Permalink to &quot;1. Package Structure&quot;">​</a></h2><p>The solution ships as <strong>three NuGet packages</strong>, each with a distinct responsibility and target framework range.</p>',9)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-104",class:"mermaid",graph:"graph%20TD%0A%20%20%20%20subgraph%20Core%20Package%0A%20%20%20%20%20%20%20%20CORE%5B%22ErrorLens.ErrorHandling%3Cbr%2F%3E%3Ci%3Enet6.0%20-%20net10.0%3C%2Fi%3E%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20OpenAPI%20Packages%0A%20%20%20%20%20%20%20%20OPENAPI%5B%22ErrorLens.ErrorHandling.OpenApi%3Cbr%2F%3E%3Ci%3Enet9.0%20-%20net10.0%3C%2Fi%3E%3Cbr%2F%3EMicrosoft.AspNetCore.OpenApi%22%5D%0A%20%20%20%20%20%20%20%20SWASH%5B%22ErrorLens.ErrorHandling.Swashbuckle%3Cbr%2F%3E%3Ci%3Enet6.0%20-%20net8.0%3C%2Fi%3E%3Cbr%2F%3ESwashbuckle.AspNetCore.SwaggerGen%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20OPENAPI%20--%3E%7CProjectReference%7C%20CORE%0A%20%20%20%20SWASH%20--%3E%7CProjectReference%7C%20CORE%0A%0A%20%20%20%20CORE%20-.-%3E%7CInternalsVisibleTo%7C%20OPENAPI%0A%20%20%20%20CORE%20-.-%3E%7CInternalsVisibleTo%7C%20SWASH%0A%0A%20%20%20%20style%20CORE%20fill%3A%232563eb%2Ccolor%3A%23fff%2Cstroke%3A%231e40af%0A%20%20%20%20style%20OPENAPI%20fill%3A%23059669%2Ccolor%3A%23fff%2Cstroke%3A%23047857%0A%20%20%20%20style%20SWASH%20fill%3A%23d97706%2Ccolor%3A%23fff%2Cstroke%3A%23b45309%0A"})]),fallback:t(()=>[...e[0]||(e[0]=[i(" Loading... ",-1)])]),_:1})),e[15]||(e[15]=o(`<table tabindex="0"><thead><tr><th>Package</th><th>Target Frameworks</th><th>Purpose</th></tr></thead><tbody><tr><td><strong>ErrorLens.ErrorHandling</strong></td><td>net6.0 - net10.0</td><td>Core middleware, handlers, mappers, models, configuration, localization, telemetry, rate limiting, serialization</td></tr><tr><td><strong>ErrorLens.ErrorHandling.OpenApi</strong></td><td>net9.0 - net10.0</td><td><code>IOpenApiOperationTransformer</code> integration for the native .NET 9+ OpenAPI pipeline</td></tr><tr><td><strong>ErrorLens.ErrorHandling.Swashbuckle</strong></td><td>net6.0 - net8.0</td><td><code>IOperationFilter</code> integration for Swashbuckle/Swagger on older frameworks</td></tr></tbody></table><p>Both OpenAPI packages share the <strong>internal</strong> <code>ErrorResponseSchemaGenerator</code> class from the core package (via <code>InternalsVisibleTo</code>), ensuring schema generation logic is defined once.</p><h3 id="core-package-directory-layout" tabindex="-1">Core Package Directory Layout <a class="header-anchor" href="#core-package-directory-layout" aria-label="Permalink to &quot;Core Package Directory Layout&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>src/ErrorLens.ErrorHandling/</span></span>
<span class="line"><span>  Attributes/              -- ResponseErrorCode, ResponseStatus, ResponseErrorProperty</span></span>
<span class="line"><span>  Configuration/           -- ErrorHandlingOptions, enums, JsonFieldNamesOptions, validator</span></span>
<span class="line"><span>  Extensions/              -- ServiceCollection, ApplicationBuilder, ConfigurationBuilder</span></span>
<span class="line"><span>  Handlers/                -- IApiExceptionHandler chain + AbstractApiExceptionHandler</span></span>
<span class="line"><span>  Integration/             -- Middleware, IExceptionHandler, ErrorResponseWriter</span></span>
<span class="line"><span>  Internal/                -- ExceptionMetadataCache, StringUtils</span></span>
<span class="line"><span>  Localization/            -- IErrorMessageLocalizer + NoOp + StringLocalizer bridge</span></span>
<span class="line"><span>  Mappers/                 -- IErrorCodeMapper, IErrorMessageMapper, IHttpStatusMapper</span></span>
<span class="line"><span>  Models/                  -- ApiErrorResponse, ApiFieldError, ApiGlobalError, ApiParameterError</span></span>
<span class="line"><span>  OpenApi/                 -- ErrorResponseSchemaGenerator, OpenApiOptions (internal)</span></span>
<span class="line"><span>  ProblemDetails/          -- IProblemDetailFactory, ProblemDetailFactory, ProblemDetailResponse</span></span>
<span class="line"><span>  RateLimiting/            -- IRateLimitResponseWriter, DefaultRateLimitResponseWriter, options</span></span>
<span class="line"><span>  Serialization/           -- ApiErrorResponseConverter (custom JSON field names)</span></span>
<span class="line"><span>  Services/                -- ErrorHandlingFacade, ILoggingService, LoggingService,</span></span>
<span class="line"><span>                              IApiErrorResponseCustomizer, ILoggingFilter</span></span>
<span class="line"><span>  Telemetry/               -- ErrorHandlingActivitySource</span></span></code></pre></div><hr><h2 id="_2-high-level-architecture" tabindex="-1">2. High-Level Architecture <a class="header-anchor" href="#_2-high-level-architecture" aria-label="Permalink to &quot;2. High-Level Architecture&quot;">​</a></h2>`,6)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-166",class:"mermaid",graph:"graph%20TB%0A%20%20%20%20REQ%5B%22Incoming%20HTTP%20Request%22%5D%20--%3E%20MW%7B%22Middleware%20%2F%20IExceptionHandler%22%7D%0A%0A%20%20%20%20MW%20--%3E%7CException%20caught%7C%20FACADE%5B%22ErrorHandlingFacade%22%5D%0A%0A%20%20%20%20FACADE%20--%3E%20CHAIN%5B%22Handler%20Chain%3Cbr%2F%3E(IApiExceptionHandler%5B%5D)%22%5D%0A%20%20%20%20CHAIN%20--%3E%7CNo%20handler%20matched%7C%20FB%5B%22IFallbackApiExceptionHandler%3Cbr%2F%3E(DefaultFallbackHandler)%22%5D%0A%20%20%20%20CHAIN%20--%3E%7CHandler%20matched%7C%20RESP%5B%22ApiErrorResponse%22%5D%0A%20%20%20%20FB%20--%3E%20RESP%0A%0A%20%20%20%20FACADE%20--%3E%20CUST%5B%22IApiErrorResponseCustomizer%5B%5D%22%5D%0A%20%20%20%20CUST%20--%3E%20RESP2%5B%22Customized%20Response%22%5D%0A%0A%20%20%20%20FACADE%20--%3E%20LOG%5B%22ILoggingService%22%5D%0A%20%20%20%20FACADE%20--%3E%20LOC%5B%22IErrorMessageLocalizer%22%5D%0A%20%20%20%20FACADE%20--%3E%20TEL%5B%22ActivitySource%3Cbr%2F%3E(Telemetry)%22%5D%0A%0A%20%20%20%20RESP2%20--%3E%20WRITER%5B%22ErrorResponseWriter%22%5D%0A%0A%20%20%20%20WRITER%20--%3E%7CUseProblemDetailFormat%3Dfalse%7C%20JSON%5B%22application%2Fjson%3Cbr%2F%3EApiErrorResponse%22%5D%0A%20%20%20%20WRITER%20--%3E%7CUseProblemDetailFormat%3Dtrue%7C%20PD%5B%22application%2Fproblem%2Bjson%3Cbr%2F%3EProblemDetailResponse%22%5D%0A%0A%20%20%20%20JSON%20--%3E%20CLIENT%5B%22HTTP%20Response%22%5D%0A%20%20%20%20PD%20--%3E%20CLIENT%0A%0A%20%20%20%20style%20FACADE%20fill%3A%232563eb%2Ccolor%3A%23fff%0A%20%20%20%20style%20CHAIN%20fill%3A%237c3aed%2Ccolor%3A%23fff%0A%20%20%20%20style%20WRITER%20fill%3A%23059669%2Ccolor%3A%23fff%0A%20%20%20%20style%20MW%20fill%3A%23dc2626%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[1]||(e[1]=[i(" Loading... ",-1)])]),_:1})),e[16]||(e[16]=o('<p>The architecture follows a <strong>Facade pattern</strong> at its core. The <code>ErrorHandlingFacade</code> orchestrates handler selection, customization, logging, localization, and telemetry enrichment. The <code>ErrorResponseWriter</code> handles format selection (standard JSON vs. RFC 9457 Problem Details) and serialization with cached <code>JsonSerializerOptions</code>.</p><hr><h2 id="_3-error-handling-pipeline-flow" tabindex="-1">3. Error Handling Pipeline Flow <a class="header-anchor" href="#_3-error-handling-pipeline-flow" aria-label="Permalink to &quot;3. Error Handling Pipeline Flow&quot;">​</a></h2><p>This diagram shows the complete lifecycle of an exception from throw to HTTP response.</p>',4)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-177",class:"mermaid",graph:"flowchart%20TD%0A%20%20%20%20A%5B%22Exception%20thrown%20in%3Cbr%2F%3Econtroller%20%2F%20endpoint%22%5D%20--%3E%20B%7B%22Options.Enabled%3F%22%7D%0A%20%20%20%20B%20--%3E%7Cfalse%7C%20B1%5B%22Rethrow%20via%3Cbr%2F%3EExceptionDispatchInfo%22%5D%0A%20%20%20%20B%20--%3E%7Ctrue%7C%20C%5B%22Start%20Activity%3Cbr%2F%3E(ErrorLens.HandleException)%22%5D%0A%0A%20%20%20%20C%20--%3E%20D%5B%22Iterate%20handlers%3Cbr%2F%3Esorted%20by%20Order%20ASC%22%5D%0A%20%20%20%20D%20--%3E%20E%7B%22handler.CanHandle(ex)%3F%22%7D%0A%20%20%20%20E%20--%3E%7Cyes%7C%20F%5B%22handler.Handle(ex)%3Cbr%2F%3Ereturns%20ApiErrorResponse%22%5D%0A%20%20%20%20E%20--%3E%7Cno%2C%20next%20handler%7C%20D%0A%20%20%20%20E%20--%3E%7Cno%20handlers%20match%7C%20G%5B%22fallbackHandler.Handle(ex)%22%5D%0A%0A%20%20%20%20F%20--%3E%20H%7B%22HttpStatusInJsonResponse%3F%22%7D%0A%20%20%20%20G%20--%3E%20H%0A%20%20%20%20H%20--%3E%7Ctrue%7C%20H1%5B%22Set%20response.Status%20%3D%20statusCode%22%5D%0A%20%20%20%20H%20--%3E%7Cfalse%7C%20I%5B%22Apply%20Customizers%22%5D%0A%20%20%20%20H1%20--%3E%20I%0A%0A%20%20%20%20I%20--%3E%20J%5B%22foreach%20customizer%3A%3Cbr%2F%3Ecustomizer.Customize(response)%22%5D%0A%20%20%20%20J%20--%3E%20K%5B%22LoggingService.LogException()%22%5D%0A%0A%20%20%20%20K%20--%3E%20K1%7B%22ILoggingFilter%5B%5D.ShouldLog()%3F%22%7D%0A%20%20%20%20K1%20--%3E%7Cfiltered%20out%7C%20L%5B%22Skip%20logging%22%5D%0A%20%20%20%20K1%20--%3E%7Callowed%7C%20K2%7B%22ExceptionLogging%20level%3F%22%7D%0A%20%20%20%20K2%20--%3E%7CNone%7C%20L%0A%20%20%20%20K2%20--%3E%7CMessageOnly%7C%20K3%5B%22Log%20code%20%2B%20message%22%5D%0A%20%20%20%20K2%20--%3E%7CWithStacktrace%7C%20K4%5B%22Log%20code%20%2B%20message%20%2B%20exception%22%5D%0A%0A%20%20%20%20L%20--%3E%20M%5B%22Localize%20messages%3Cbr%2F%3E(IErrorMessageLocalizer)%22%5D%0A%20%20%20%20K3%20--%3E%20M%0A%20%20%20%20K4%20--%3E%20M%0A%0A%20%20%20%20M%20--%3E%20N%5B%22Enrich%20Activity%20tags%3Cbr%2F%3E(error.code%2C%20error.type%2C%3Cbr%2F%3Ehttp.response.status_code)%22%5D%0A%20%20%20%20N%20--%3E%20O%5B%22Add%20OTel%20exception%20event%22%5D%0A%0A%20%20%20%20O%20--%3E%20P%5B%22ErrorResponseWriter%3Cbr%2F%3E.WriteResponseAsync()%22%5D%0A%0A%20%20%20%20P%20--%3E%20Q%7B%22Response.HasStarted%3F%22%7D%0A%20%20%20%20Q%20--%3E%7Cyes%7C%20R%5B%22Return%20(no-op)%22%5D%0A%20%20%20%20Q%20--%3E%7Cno%7C%20S%7B%22UseProblemDetailFormat%3F%22%7D%0A%0A%20%20%20%20S%20--%3E%7Cfalse%7C%20T%5B%22Serialize%20ApiErrorResponse%3Cbr%2F%3Evia%20ApiErrorResponseConverter%3Cbr%2F%3EContent-Type%3A%20application%2Fjson%22%5D%0A%20%20%20%20S%20--%3E%7Ctrue%7C%20U%5B%22ProblemDetailFactory%3Cbr%2F%3E.CreateFromApiError()%3Cbr%2F%3EContent-Type%3A%20application%2Fproblem%2Bjson%22%5D%0A%0A%20%20%20%20T%20--%3E%20V%5B%22HTTP%20Response%20written%22%5D%0A%20%20%20%20U%20--%3E%20V%0A%0A%20%20%20%20style%20A%20fill%3A%23dc2626%2Ccolor%3A%23fff%0A%20%20%20%20style%20C%20fill%3A%237c3aed%2Ccolor%3A%23fff%0A%20%20%20%20style%20F%20fill%3A%23059669%2Ccolor%3A%23fff%0A%20%20%20%20style%20G%20fill%3A%23d97706%2Ccolor%3A%23fff%0A%20%20%20%20style%20V%20fill%3A%232563eb%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[2]||(e[2]=[i(" Loading... ",-1)])]),_:1})),e[17]||(e[17]=o('<h3 id="key-pipeline-behaviors" tabindex="-1">Key pipeline behaviors <a class="header-anchor" href="#key-pipeline-behaviors" aria-label="Permalink to &quot;Key pipeline behaviors&quot;">​</a></h3><ul><li><strong>Guard clause:</strong> If <code>Enabled</code> is <code>false</code>, the exception is rethrown preserving the original stack trace via <code>ExceptionDispatchInfo.Capture().Throw()</code>.</li><li><strong>Handler safety net:</strong> If any handler throws during processing, the facade catches it, logs both exceptions, and returns a safe 500 response (<code>INTERNAL_SERVER_ERROR</code> / <code>&quot;An unexpected error occurred&quot;</code>) to prevent information leakage.</li><li><strong>Response-already-started guard:</strong> <code>ErrorResponseWriter</code> checks <code>HttpContext.Response.HasStarted</code> before writing, preventing <code>InvalidOperationException</code> when headers have already been sent.</li></ul><hr><h2 id="_4-dependency-injection-registration" tabindex="-1">4. Dependency Injection Registration <a class="header-anchor" href="#_4-dependency-injection-registration" aria-label="Permalink to &quot;4. Dependency Injection Registration&quot;">​</a></h2><p>The <code>AddErrorHandling()</code> extension method on <code>IServiceCollection</code> registers all core services. The registration uses <code>TryAdd*</code> methods throughout to enable idempotent calls and allow user overrides.</p>',5)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-205",class:"mermaid",graph:"graph%20TD%0A%20%20%20%20subgraph%20Entry%20Points%0A%20%20%20%20%20%20%20%20AEH1%5B%22AddErrorHandling()%22%5D%0A%20%20%20%20%20%20%20%20AEH2%5B%22AddErrorHandling(Action%26lt%3BOptions%26gt%3B)%22%5D%0A%20%20%20%20%20%20%20%20AEH3%5B%22AddErrorHandling(IConfiguration)%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20AEH1%20--%3E%20AEH2%0A%20%20%20%20AEH2%20--%3E%20BIND%5B%22Bind%20'ErrorHandling'%20section%3Cbr%2F%3E%2B%20apply%20Action%20configure%22%5D%0A%20%20%20%20AEH3%20--%3E%20BIND3%5B%22Bind%20IConfiguration%20section%22%5D%0A%20%20%20%20BIND%20--%3E%20RCS%5B%22RegisterCoreServices()%22%5D%0A%20%20%20%20BIND3%20--%3E%20RCS%0A%0A%20%20%20%20subgraph%20RegisterCoreServices%0A%20%20%20%20%20%20%20%20direction%20TB%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20VAL%5B%22IValidateOptions%26lt%3BErrorHandlingOptions%26gt%3B%3Cbr%2F%3EErrorHandlingOptionsValidator%22%5D%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20ECM%5B%22IErrorCodeMapper%20-%3E%20ErrorCodeMapper%22%5D%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20EMM%5B%22IErrorMessageMapper%20-%3E%20ErrorMessageMapper%22%5D%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20HSM%5B%22IHttpStatusMapper%20-%3E%20HttpStatusMapper%22%5D%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20LS%5B%22ILoggingService%20-%3E%20LoggingService%22%5D%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20LOC%5B%22IErrorMessageLocalizer%20-%3E%20NoOpErrorMessageLocalizer%22%5D%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20FBH%5B%22IFallbackApiExceptionHandler%20-%3E%20DefaultFallbackHandler%22%5D%0A%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20H1%5B%22IApiExceptionHandler%3A%206%20built-in%20handlers%22%5D%0A%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20ABO%5B%22ApiBehaviorOptions%3Cbr%2F%3E(conditional%20ModelState%20override)%22%5D%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20FAC%5B%22ErrorHandlingFacade%22%5D%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20PDF%5B%22IProblemDetailFactory%20-%3E%20ProblemDetailFactory%22%5D%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20ERW%5B%22ErrorResponseWriter%22%5D%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20MWR%5B%22ErrorHandlingMiddleware%22%5D%0A%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20RL%5B%22IRateLimitResponseWriter%3Cbr%2F%3EDefaultRateLimitResponseWriter%3Cbr%2F%3E%3Ci%3E(NET7_0_OR_GREATER)%3C%2Fi%3E%22%5D%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20EXH%5B%22IExceptionHandler%3Cbr%2F%3EErrorHandlingExceptionHandler%3Cbr%2F%3E%3Ci%3E(NET8_0_OR_GREATER)%3C%2Fi%3E%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20User%20Extension%20Points%0A%20%20%20%20%20%20%20%20UH%5B%22AddApiExceptionHandler%26lt%3BT%26gt%3B()%22%5D%0A%20%20%20%20%20%20%20%20UC%5B%22AddErrorResponseCustomizer%26lt%3BT%26gt%3B()%22%5D%0A%20%20%20%20%20%20%20%20UL%5B%22AddErrorHandlingLocalization%26lt%3BT%26gt%3B()%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20UH%20--%3E%7CTryAddEnumerable%7C%20H1%0A%20%20%20%20UC%20--%3E%7CTryAddEnumerable%7C%20CUS%5B%22IApiErrorResponseCustomizer%22%5D%0A%20%20%20%20UL%20--%3E%7CReplace%7C%20LOC2%5B%22StringLocalizerErrorMessageLocalizer%26lt%3BT%26gt%3B%22%5D%0A%0A%20%20%20%20style%20RCS%20fill%3A%232563eb%2Ccolor%3A%23fff%0A%20%20%20%20style%20FAC%20fill%3A%237c3aed%2Ccolor%3A%23fff%0A%20%20%20%20style%20ERW%20fill%3A%23059669%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[3]||(e[3]=[i(" Loading... ",-1)])]),_:1})),e[18]||(e[18]=o('<h3 id="registration-semantics" tabindex="-1">Registration semantics <a class="header-anchor" href="#registration-semantics" aria-label="Permalink to &quot;Registration semantics&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Method</th><th>Idempotency</th><th>Notes</th></tr></thead><tbody><tr><td><code>TryAddSingleton&lt;I, T&gt;</code></td><td>First registration wins</td><td>Used for mappers, logging, facade, writer</td></tr><tr><td><code>TryAddEnumerable(Singleton&lt;I, T&gt;)</code></td><td>One per concrete type</td><td>Used for handlers and customizers</td></tr><tr><td><code>Replace(ServiceDescriptor)</code></td><td>Overwrites existing</td><td>Used by <code>AddErrorHandlingLocalization&lt;T&gt;()</code></td></tr><tr><td><code>AddExceptionHandler&lt;T&gt;()</code></td><td>Framework method</td><td>.NET 8+ <code>IExceptionHandler</code> registration</td></tr></tbody></table><p>All services are registered as <strong>Singleton</strong>. They resolve <code>IOptions&lt;ErrorHandlingOptions&gt;.Value</code> once in their constructors, meaning configuration values are frozen at first resolution.</p><hr><h2 id="_5-handler-chain-of-responsibility" tabindex="-1">5. Handler Chain of Responsibility <a class="header-anchor" href="#_5-handler-chain-of-responsibility" aria-label="Permalink to &quot;5. Handler Chain of Responsibility&quot;">​</a></h2><p>Handlers implement <code>IApiExceptionHandler</code> and are ordered by their <code>Order</code> property (ascending -- lower values execute first). The facade iterates through them calling <code>CanHandle()</code> until one matches. If none match, the <code>IFallbackApiExceptionHandler</code> handles the exception.</p>',6)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-280",class:"mermaid",graph:"graph%20LR%0A%20%20%20%20EX%5B%22Exception%22%5D%20--%3E%20AGG%0A%0A%20%20%20%20subgraph%20Handler%20Chain%20-%20sorted%20by%20Order%0A%20%20%20%20%20%20%20%20AGG%5B%22AggregateExceptionHandler%3Cbr%2F%3EOrder%3A%2050%22%5D%0A%20%20%20%20%20%20%20%20MSV%5B%22ModelStateValidation%3Cbr%2F%3EExceptionHandler%3Cbr%2F%3EOrder%3A%2090%22%5D%0A%20%20%20%20%20%20%20%20VEH%5B%22ValidationException%3Cbr%2F%3EHandler%3Cbr%2F%3EOrder%3A%20100%22%5D%0A%20%20%20%20%20%20%20%20JEH%5B%22JsonException%3Cbr%2F%3EHandler%3Cbr%2F%3EOrder%3A%20120%22%5D%0A%20%20%20%20%20%20%20%20TMH%5B%22TypeMismatch%3Cbr%2F%3EExceptionHandler%3Cbr%2F%3EOrder%3A%20130%22%5D%0A%20%20%20%20%20%20%20%20BRH%5B%22BadRequest%3Cbr%2F%3EExceptionHandler%3Cbr%2F%3EOrder%3A%20150%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20AGG%20--%3E%7CCanHandle%3Dfalse%7C%20MSV%0A%20%20%20%20MSV%20--%3E%7CCanHandle%3Dfalse%7C%20VEH%0A%20%20%20%20VEH%20--%3E%7CCanHandle%3Dfalse%7C%20JEH%0A%20%20%20%20JEH%20--%3E%7CCanHandle%3Dfalse%7C%20TMH%0A%20%20%20%20TMH%20--%3E%7CCanHandle%3Dfalse%7C%20BRH%0A%20%20%20%20BRH%20--%3E%7CCanHandle%3Dfalse%7C%20FB%5B%22DefaultFallbackHandler%3Cbr%2F%3E(catch-all)%22%5D%0A%0A%20%20%20%20style%20AGG%20fill%3A%237c3aed%2Ccolor%3A%23fff%0A%20%20%20%20style%20FB%20fill%3A%23d97706%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[4]||(e[4]=[i(" Loading... ",-1)])]),_:1})),e[19]||(e[19]=o('<table tabindex="0"><thead><tr><th>Handler</th><th>Order</th><th>Exception Type</th><th>Status Code</th><th>Error Code</th></tr></thead><tbody><tr><td><code>AggregateExceptionHandler</code></td><td>50</td><td><code>AggregateException</code></td><td>Delegates to inner</td><td>Re-dispatches</td></tr><tr><td><code>ModelStateValidationExceptionHandler</code></td><td>90</td><td><code>ModelStateValidationException</code></td><td>400</td><td><code>VALIDATION_FAILED</code></td></tr><tr><td><code>ValidationExceptionHandler</code></td><td>100</td><td><code>ValidationException</code></td><td>400</td><td><code>VALIDATION_FAILED</code></td></tr><tr><td><code>JsonExceptionHandler</code></td><td>120</td><td><code>JsonException</code></td><td>400</td><td><code>MESSAGE_NOT_READABLE</code></td></tr><tr><td><code>TypeMismatchExceptionHandler</code></td><td>130</td><td><code>FormatException</code>, <code>InvalidCastException</code></td><td>400</td><td><code>TYPE_MISMATCH</code></td></tr><tr><td><code>BadRequestExceptionHandler</code></td><td>150</td><td><code>BadHttpRequestException</code></td><td>from exception</td><td><code>BAD_REQUEST</code></td></tr><tr><td><code>DefaultFallbackHandler</code></td><td>N/A</td><td>Any</td><td>Attribute / mapper</td><td>Attribute / mapper</td></tr></tbody></table><p><strong>Custom handlers</strong> added via <code>AddApiExceptionHandler&lt;T&gt;()</code> participate in the same chain. The <code>AbstractApiExceptionHandler</code> base class provides <code>Order =&gt; 1000</code> by default and a <code>CreateResponse()</code> helper.</p><h3 id="aggregateexception-unwrapping" tabindex="-1">AggregateException unwrapping <a class="header-anchor" href="#aggregateexception-unwrapping" aria-label="Permalink to &quot;AggregateException unwrapping&quot;">​</a></h3><p><code>AggregateExceptionHandler</code> flattens nested aggregates via <code>Flatten()</code>. If there is exactly <strong>one</strong> inner exception, it lazily resolves handlers from <code>IServiceProvider</code> (to break circular DI), skips itself to prevent recursion, and re-dispatches to the chain. Multi-exception aggregates are delegated to the fallback handler.</p><hr><h2 id="_6-configuration-architecture" tabindex="-1">6. Configuration Architecture <a class="header-anchor" href="#_6-configuration-architecture" aria-label="Permalink to &quot;6. Configuration Architecture&quot;">​</a></h2>',6)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-436",class:"mermaid",graph:"flowchart%20TD%0A%20%20%20%20subgraph%20Configuration%20Sources%0A%20%20%20%20%20%20%20%20APS%5B%22appsettings.json%3Cbr%2F%3ESection%3A%20'ErrorHandling'%22%5D%0A%20%20%20%20%20%20%20%20YAML%5B%22errorhandling.yml%3Cbr%2F%3E(via%20AddYamlErrorHandling)%22%5D%0A%20%20%20%20%20%20%20%20INLINE%5B%22Inline%20Action%26lt%3BErrorHandlingOptions%26gt%3B%22%5D%0A%20%20%20%20%20%20%20%20ICONFIG%5B%22IConfiguration%20binding%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20APS%20--%3E%20MERGE%5B%22IConfiguration%3Cbr%2F%3Emerged%20key-value%20store%22%5D%0A%20%20%20%20YAML%20--%3E%20MERGE%0A%20%20%20%20MERGE%20--%3E%20BIND%5B%22Options%20binding%20pipeline%22%5D%0A%20%20%20%20ICONFIG%20--%3E%20BIND%0A%20%20%20%20INLINE%20--%3E%20BIND%0A%0A%20%20%20%20BIND%20--%3E%20OPT%5B%22ErrorHandlingOptions%22%5D%0A%0A%20%20%20%20OPT%20--%3E%20VAL%5B%22ErrorHandlingOptionsValidator%3Cbr%2F%3E(IValidateOptions)%22%5D%0A%20%20%20%20VAL%20--%3E%7CFail%7C%20STARTUP_ERR%5B%22OptionsValidationException%3Cbr%2F%3Eat%20first%20resolve%22%5D%0A%20%20%20%20VAL%20--%3E%7CPass%7C%20RESOLVED%5B%22Validated%20options%3Cbr%2F%3Eavailable%20via%20IOptions%22%5D%0A%0A%20%20%20%20style%20OPT%20fill%3A%232563eb%2Ccolor%3A%23fff%0A%20%20%20%20style%20VAL%20fill%3A%23dc2626%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[5]||(e[5]=[i(" Loading... ",-1)])]),_:1})),e[20]||(e[20]=o('<h3 id="configuration-binding-order" tabindex="-1">Configuration binding order <a class="header-anchor" href="#configuration-binding-order" aria-label="Permalink to &quot;Configuration binding order&quot;">​</a></h3><ol><li><code>IConfiguration</code> section binding runs first (from <code>appsettings.json</code>, YAML, environment variables, etc.)</li><li>The inline <code>Action&lt;ErrorHandlingOptions&gt;</code> runs second, so it can override file-based values.</li></ol><h3 id="options-validation" tabindex="-1">Options validation <a class="header-anchor" href="#options-validation" aria-label="Permalink to &quot;Options validation&quot;">​</a></h3><p><code>ErrorHandlingOptionsValidator</code> runs at first <code>IOptions&lt;ErrorHandlingOptions&gt;</code> resolution and validates:</p><ul><li>All <code>JsonFieldNamesOptions</code> properties are non-null and non-whitespace.</li><li>All field name values are unique (no duplicates like <code>code</code> and <code>message</code> mapped to the same JSON key).</li></ul><h3 id="errorhandlingoptions-properties" tabindex="-1">ErrorHandlingOptions properties <a class="header-anchor" href="#errorhandlingoptions-properties" aria-label="Permalink to &quot;ErrorHandlingOptions properties&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Property</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>Enabled</code></td><td><code>bool</code></td><td><code>true</code></td><td>Enable/disable error handling globally</td></tr><tr><td><code>DefaultErrorCodeStrategy</code></td><td><code>ErrorCodeStrategy</code></td><td><code>AllCaps</code></td><td><code>AllCaps</code> or <code>FullQualifiedName</code></td></tr><tr><td><code>HttpStatusInJsonResponse</code></td><td><code>bool</code></td><td><code>false</code></td><td>Include HTTP status code in JSON body</td></tr><tr><td><code>SearchSuperClassHierarchy</code></td><td><code>bool</code></td><td><code>false</code></td><td>Search base classes for config matches</td></tr><tr><td><code>AddPathToError</code></td><td><code>bool</code></td><td><code>true</code></td><td>Include property path in field errors</td></tr><tr><td><code>OverrideModelStateValidation</code></td><td><code>bool</code></td><td><code>false</code></td><td>Intercept <code>[ApiController]</code> validation</td></tr><tr><td><code>UseProblemDetailFormat</code></td><td><code>bool</code></td><td><code>false</code></td><td>Enable RFC 9457 Problem Details format</td></tr><tr><td><code>ProblemDetailTypePrefix</code></td><td><code>string</code></td><td><code>https://example.com/errors/</code></td><td>Type URI prefix for Problem Details</td></tr><tr><td><code>ProblemDetailConvertToKebabCase</code></td><td><code>bool</code></td><td><code>true</code></td><td>Convert error codes to kebab-case in type URI</td></tr><tr><td><code>ExceptionLogging</code></td><td><code>ExceptionLogging</code></td><td><code>MessageOnly</code></td><td><code>None</code>, <code>MessageOnly</code>, <code>WithStacktrace</code></td></tr><tr><td><code>HttpStatuses</code></td><td><code>Dictionary&lt;string, HttpStatusCode&gt;</code></td><td><code>{}</code></td><td>Exception FQN to HTTP status mappings</td></tr><tr><td><code>Codes</code></td><td><code>Dictionary&lt;string, string&gt;</code></td><td><code>{}</code></td><td>Exception FQN or field-specific error code mappings</td></tr><tr><td><code>Messages</code></td><td><code>Dictionary&lt;string, string&gt;</code></td><td><code>{}</code></td><td>Exception FQN or field-specific message mappings</td></tr><tr><td><code>LogLevels</code></td><td><code>Dictionary&lt;string, LogLevel&gt;</code></td><td><code>{}</code></td><td>HTTP status code/range to log level</td></tr><tr><td><code>FullStacktraceHttpStatuses</code></td><td><code>HashSet&lt;string&gt;</code></td><td><code>{}</code></td><td>HTTP statuses that force full stack trace logging</td></tr><tr><td><code>FullStacktraceClasses</code></td><td><code>HashSet&lt;string&gt;</code></td><td><code>{}</code></td><td>Exception types that force full stack trace logging</td></tr><tr><td><code>JsonFieldNames</code></td><td><code>JsonFieldNamesOptions</code></td><td><em>(defaults)</em></td><td>Custom JSON field names (10 configurable fields)</td></tr><tr><td><code>RateLimiting</code></td><td><code>RateLimitingOptions</code></td><td><em>(defaults)</em></td><td>Rate limiting response options</td></tr><tr><td><code>OpenApi</code></td><td><code>OpenApiOptions</code></td><td><code>DefaultStatusCodes: {400, 404, 500}</code></td><td>OpenAPI schema generation options</td></tr></tbody></table><hr><h2 id="_7-attribute-system-and-metadata-caching" tabindex="-1">7. Attribute System and Metadata Caching <a class="header-anchor" href="#_7-attribute-system-and-metadata-caching" aria-label="Permalink to &quot;7. Attribute System and Metadata Caching&quot;">​</a></h2><p>Three attributes allow exception classes to declare their error response behavior declaratively:</p>',10)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-766",class:"mermaid",graph:"classDiagram%0A%20%20%20%20class%20ResponseErrorCodeAttribute%20%7B%0A%20%20%20%20%20%20%20%20%2Bstring%20Code%0A%20%20%20%20%20%20%20%20AttributeUsage%3A%20Class%0A%20%20%20%20%7D%0A%0A%20%20%20%20class%20ResponseStatusAttribute%20%7B%0A%20%20%20%20%20%20%20%20%2BHttpStatusCode%20StatusCode%0A%20%20%20%20%20%20%20%20AttributeUsage%3A%20Class%0A%20%20%20%20%7D%0A%0A%20%20%20%20class%20ResponseErrorPropertyAttribute%20%7B%0A%20%20%20%20%20%20%20%20%2Bstring%20Name%0A%20%20%20%20%20%20%20%20%2Bbool%20IncludeIfNull%0A%20%20%20%20%20%20%20%20AttributeUsage%3A%20Property%0A%20%20%20%20%7D%0A%0A%20%20%20%20class%20ExceptionMetadataCache%20%7B%0A%20%20%20%20%20%20%20%20-ConcurrentDictionary~Type%2C%20ExceptionMetadata~%20_cache%0A%20%20%20%20%20%20%20%20%2BGetMetadata(Type)%20ExceptionMetadata%0A%20%20%20%20%7D%0A%0A%20%20%20%20class%20ExceptionMetadata%20%7B%0A%20%20%20%20%20%20%20%20%2Bstring%20ErrorCode%0A%20%20%20%20%20%20%20%20%2BHttpStatusCode%20StatusCode%0A%20%20%20%20%20%20%20%20%2BIReadOnlyList~PropertyMetadata~%20Properties%0A%20%20%20%20%7D%0A%0A%20%20%20%20class%20PropertyMetadata%20%7B%0A%20%20%20%20%20%20%20%20%2BPropertyInfo%20Property%0A%20%20%20%20%20%20%20%20%2Bstring%20Name%0A%20%20%20%20%20%20%20%20%2Bbool%20IncludeIfNull%0A%20%20%20%20%7D%0A%0A%20%20%20%20ExceptionMetadataCache%20--%3E%20ExceptionMetadata%20%3A%20caches%0A%20%20%20%20ExceptionMetadata%20--%3E%20PropertyMetadata%20%3A%20contains%0A%20%20%20%20ResponseErrorCodeAttribute%20..%3E%20ExceptionMetadata%20%3A%20read%20by%20cache%0A%20%20%20%20ResponseStatusAttribute%20..%3E%20ExceptionMetadata%20%3A%20read%20by%20cache%0A%20%20%20%20ResponseErrorPropertyAttribute%20..%3E%20PropertyMetadata%20%3A%20read%20by%20cache%0A"})]),fallback:t(()=>[...e[6]||(e[6]=[i(" Loading... ",-1)])]),_:1})),e[21]||(e[21]=o('<p><code>ExceptionMetadataCache</code> is a <strong>static, thread-safe</strong> <code>ConcurrentDictionary</code> that reflects on exception types once and caches the results. The <code>DefaultFallbackHandler</code> consults this cache to:</p><ol><li>Use <code>[ResponseErrorCode]</code> as the error code (overrides the <code>IErrorCodeMapper</code> strategy).</li><li>Use <code>[ResponseStatus]</code> as the HTTP status code (overrides the <code>IHttpStatusMapper</code>).</li><li>Extract <code>[ResponseErrorProperty]</code>-decorated properties and add them to <code>ApiErrorResponse.Properties</code> (serialized via <code>[JsonExtensionData]</code>).</li></ol><p>Property names default to camelCase conversion of the C# property name unless overridden via the <code>Name</code> parameter.</p><hr><h2 id="_8-serialization-and-response-writing" tabindex="-1">8. Serialization and Response Writing <a class="header-anchor" href="#_8-serialization-and-response-writing" aria-label="Permalink to &quot;8. Serialization and Response Writing&quot;">​</a></h2><p><code>ErrorResponseWriter</code> caches a single <code>JsonSerializerOptions</code> instance at construction, including the custom <code>ApiErrorResponseConverter</code>. This avoids per-request allocation.</p>',6)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-797",class:"mermaid",graph:"flowchart%20LR%0A%20%20%20%20subgraph%20ErrorResponseWriter%0A%20%20%20%20%20%20%20%20direction%20TB%0A%20%20%20%20%20%20%20%20OPTS%5B%22JsonSerializerOptions%3Cbr%2F%3E(cached%20at%20construction)%22%5D%0A%20%20%20%20%20%20%20%20CONV%5B%22ApiErrorResponseConverter%3Cbr%2F%3E(uses%20JsonFieldNamesOptions)%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20OPTS%20--%3E%20CONV%0A%0A%20%20%20%20CONV%20--%3E%20WRITE%5B%22Custom%20Utf8JsonWriter%20logic%22%5D%0A%0A%20%20%20%20WRITE%20--%3E%20CODE%5B%22Write%20'code'%20(always)%22%5D%0A%20%20%20%20WRITE%20--%3E%20MSG%5B%22Write%20'message'%20(if%20non-null)%22%5D%0A%20%20%20%20WRITE%20--%3E%20STATUS%5B%22Write%20'status'%20(if%20non-zero)%22%5D%0A%20%20%20%20WRITE%20--%3E%20FE%5B%22Write%20'fieldErrors'%20array%22%5D%0A%20%20%20%20WRITE%20--%3E%20GE%5B%22Write%20'globalErrors'%20array%22%5D%0A%20%20%20%20WRITE%20--%3E%20PE%5B%22Write%20'parameterErrors'%20array%22%5D%0A%20%20%20%20WRITE%20--%3E%20PROPS%5B%22Write%20extension%20properties%3Cbr%2F%3E(skip%20collisions%20with%20built-in)%22%5D%0A%0A%20%20%20%20style%20CONV%20fill%3A%232563eb%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[7]||(e[7]=[i(" Loading... ",-1)])]),_:1})),e[22]||(e[22]=o('<p><code>ApiErrorResponseConverter</code> is a <strong>write-only</strong> <code>JsonConverter&lt;ApiErrorResponse&gt;</code> that:</p><ul><li>Uses the configured <code>JsonFieldNamesOptions</code> to determine property names at every level.</li><li>Manually writes each nested error model (<code>ApiFieldError</code>, <code>ApiGlobalError</code>, <code>ApiParameterError</code>) with the correct field names.</li><li>Filters <code>Properties</code> (extension data) to avoid collisions with built-in field names.</li><li>The <code>JsonSerializerOptions</code> instance becomes thread-safe after first serialization.</li></ul><hr><h2 id="_9-problemdetails-generation-rfc-9457" tabindex="-1">9. ProblemDetails Generation (RFC 9457) <a class="header-anchor" href="#_9-problemdetails-generation-rfc-9457" aria-label="Permalink to &quot;9. ProblemDetails Generation (RFC 9457)&quot;">​</a></h2><p>When <code>UseProblemDetailFormat</code> is <code>true</code>, <code>ErrorResponseWriter</code> delegates to <code>IProblemDetailFactory</code>.</p>',5)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-830",class:"mermaid",graph:"flowchart%20TD%0A%20%20%20%20AER%5B%22ApiErrorResponse%22%5D%20--%3E%20FACTORY%5B%22ProblemDetailFactory%22%5D%0A%0A%20%20%20%20FACTORY%20--%3E%20PDR%5B%22ProblemDetailResponse%22%5D%0A%0A%20%20%20%20PDR%20--%3E%20TYPE%5B%22type%3A%20prefix%20%2B%20kebab-code%3Cbr%2F%3Ee.g.%2C%20https%3A%2F%2Fexample.com%2Ferrors%2Fvalidation-failed%22%5D%0A%20%20%20%20PDR%20--%3E%20TITLE%5B%22title%3A%20HTTP%20reason%20phrase%3Cbr%2F%3Ee.g.%2C%20'Bad%20Request'%22%5D%0A%20%20%20%20PDR%20--%3E%20STAT%5B%22status%3A%20400%22%5D%0A%20%20%20%20PDR%20--%3E%20DETAIL%5B%22detail%3A%20error%20message%22%5D%0A%20%20%20%20PDR%20--%3E%20INST%5B%22instance%3A%20request%20path%3Cbr%2F%3E(set%20by%20ErrorResponseWriter)%22%5D%0A%0A%20%20%20%20PDR%20--%3E%20EXT%5B%22Extensions%20dictionary%22%5D%0A%20%20%20%20EXT%20--%3E%20EXTFE%5B%22fieldErrors%20(if%20any)%22%5D%0A%20%20%20%20EXT%20--%3E%20EXTGE%5B%22globalErrors%20(if%20any)%22%5D%0A%20%20%20%20EXT%20--%3E%20EXTPE%5B%22parameterErrors%20(if%20any)%22%5D%0A%20%20%20%20EXT%20--%3E%20EXTCODE%5B%22code%3A%20original%20error%20code%22%5D%0A%20%20%20%20EXT%20--%3E%20EXTCUST%5B%22custom%20properties%20from%20ResponseErrorProperty%22%5D%0A%0A%20%20%20%20style%20FACTORY%20fill%3A%232563eb%2Ccolor%3A%23fff%0A%20%20%20%20style%20PDR%20fill%3A%23059669%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[8]||(e[8]=[i(" Loading... ",-1)])]),_:1})),e[23]||(e[23]=o('<p>The <code>type</code> URI is built from <code>ProblemDetailTypePrefix</code> + the error code converted to kebab-case (e.g., <code>VALIDATION_FAILED</code> becomes <code>validation-failed</code>). This is configurable via <code>ProblemDetailConvertToKebabCase</code>.</p><hr><h2 id="_10-localization-architecture" tabindex="-1">10. Localization Architecture <a class="header-anchor" href="#_10-localization-architecture" aria-label="Permalink to &quot;10. Localization Architecture&quot;">​</a></h2>',3)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-838",class:"mermaid",graph:"flowchart%20TD%0A%20%20%20%20subgraph%20Default%20Path%20-%20no%20localization%0A%20%20%20%20%20%20%20%20NOOP%5B%22NoOpErrorMessageLocalizer%3Cbr%2F%3E(returns%20defaultMessage%20unchanged)%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20Opted-in%20Path%0A%20%20%20%20%20%20%20%20CALL%5B%22AddErrorHandlingLocalization%26lt%3BTResource%26gt%3B()%22%5D%0A%20%20%20%20%20%20%20%20CALL%20--%3E%20REP%5B%22Replace%20IErrorMessageLocalizer%3Cbr%2F%3Ewith%20StringLocalizerErrorMessageLocalizer%26lt%3BT%26gt%3B%22%5D%0A%20%20%20%20%20%20%20%20REP%20--%3E%20SL%5B%22IStringLocalizer%26lt%3BTResource%26gt%3B%22%5D%0A%20%20%20%20%20%20%20%20SL%20--%3E%20RESX%5B%22*.resx%20resource%20files%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20FACADE%5B%22ErrorHandlingFacade%22%5D%20--%3E%20LOC%7B%22IErrorMessageLocalizer%22%7D%0A%20%20%20%20LOC%20--%3E%7Cdefault%7C%20NOOP%0A%20%20%20%20LOC%20--%3E%7Copted%20in%7C%20REP%0A%0A%20%20%20%20LOC%20--%3E%20L1%5B%22Localize%20response.Message%3Cbr%2F%3Eusing%20response.Code%20as%20key%22%5D%0A%20%20%20%20LOC%20--%3E%20L2%5B%22Localize%20each%20fieldError.Message%22%5D%0A%20%20%20%20LOC%20--%3E%20L3%5B%22Localize%20each%20globalError.Message%22%5D%0A%20%20%20%20LOC%20--%3E%20L4%5B%22Localize%20each%20parameterError.Message%22%5D%0A%0A%20%20%20%20style%20FACADE%20fill%3A%232563eb%2Ccolor%3A%23fff%0A%20%20%20%20style%20LOC%20fill%3A%237c3aed%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[9]||(e[9]=[i(" Loading... ",-1)])]),_:1})),e[24]||(e[24]=o('<p>Localization is a <strong>zero-cost opt-in</strong>. The default <code>NoOpErrorMessageLocalizer</code> is a pass-through. When the user calls <code>AddErrorHandlingLocalization&lt;TResource&gt;()</code>:</p><ol><li><code>AddLocalization()</code> is called to register the Microsoft localization infrastructure.</li><li>The <code>IErrorMessageLocalizer</code> registration is <strong>replaced</strong> with <code>StringLocalizerErrorMessageLocalizer&lt;TResource&gt;</code>.</li><li>Error codes are used as resource keys in <code>.resx</code> files. If no resource is found, the default message is returned.</li></ol><p>Localization runs <strong>after</strong> handler processing and customization in the <code>ErrorHandlingFacade</code>, so it localizes the final message.</p><hr><h2 id="_11-telemetry-and-distributed-tracing" tabindex="-1">11. Telemetry and Distributed Tracing <a class="header-anchor" href="#_11-telemetry-and-distributed-tracing" aria-label="Permalink to &quot;11. Telemetry and Distributed Tracing&quot;">​</a></h2>',5)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-866",class:"mermaid",graph:"flowchart%20LR%0A%20%20%20%20FACADE%5B%22ErrorHandlingFacade%3Cbr%2F%3E.HandleException()%22%5D%20--%3E%20ACT%5B%22ActivitySource.StartActivity%3Cbr%2F%3E('ErrorLens.HandleException')%22%5D%0A%0A%20%20%20%20ACT%20--%3E%20TAG1%5B%22Tag%3A%20error.code%22%5D%0A%20%20%20%20ACT%20--%3E%20TAG2%5B%22Tag%3A%20error.type%3Cbr%2F%3E(exception%20FullName)%22%5D%0A%20%20%20%20ACT%20--%3E%20TAG3%5B%22Tag%3A%20http.response.status_code%22%5D%0A%20%20%20%20ACT%20--%3E%20EVT%5B%22Event%3A%20'exception'%3Cbr%2F%3Eexception.type%3Cbr%2F%3Eexception.message%3Cbr%2F%3Eexception.stacktrace%22%5D%0A%20%20%20%20ACT%20--%3E%20STAT%5B%22SetStatus(Error%2C%20message)%22%5D%0A%0A%20%20%20%20OTEL%5B%22OpenTelemetry%20Collector%3Cbr%2F%3E(if%20configured)%22%5D%20-.-%3E%7Clistens%20to%7C%20SRC%5B%22ActivitySource%3A%3Cbr%2F%3E'ErrorLens.ErrorHandling'%22%5D%0A%0A%20%20%20%20style%20ACT%20fill%3A%237c3aed%2Ccolor%3A%23fff%0A%20%20%20%20style%20SRC%20fill%3A%23059669%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[10]||(e[10]=[i(" Loading... ",-1)])]),_:1})),e[25]||(e[25]=o('<p><code>ErrorHandlingActivitySource</code> exposes a static <code>ActivitySource</code> named <code>&quot;ErrorLens.ErrorHandling&quot;</code>. The facade:</p><ol><li>Starts an activity named <code>&quot;ErrorLens.HandleException&quot;</code> for each exception.</li><li>Only enriches tags/events when <code>activity.IsAllDataRequested == true</code> (zero overhead when no collector is configured).</li><li>Uses OTel semantic conventions for exception events (<code>exception.type</code>, <code>exception.message</code>, <code>exception.stacktrace</code>).</li><li>Sets <code>ActivityStatusCode.Error</code> on the activity.</li></ol><hr><h2 id="_12-rate-limiting-integration" tabindex="-1">12. Rate Limiting Integration <a class="header-anchor" href="#_12-rate-limiting-integration" aria-label="Permalink to &quot;12. Rate Limiting Integration&quot;">​</a></h2><p>Available on <strong>.NET 7+</strong> only (guarded by <code>#if NET7_0_OR_GREATER</code>).</p>',5)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-899",class:"mermaid",graph:"flowchart%20TD%0A%20%20%20%20RL_MW%5B%22ASP.NET%20Core%3Cbr%2F%3ERate%20Limiter%20Middleware%22%5D%20--%3E%7COnRejected%20callback%7C%20IRLRW%5B%22IRateLimitResponseWriter%22%5D%0A%0A%20%20%20%20IRLRW%20--%3E%20DEFAULT%5B%22DefaultRateLimitResponseWriter%22%5D%0A%0A%20%20%20%20DEFAULT%20--%3E%20LEASE%5B%22Extract%20RetryAfter%3Cbr%2F%3Efrom%20RateLimitLease%20metadata%22%5D%0A%20%20%20%20DEFAULT%20--%3E%20HEADERS%5B%22Set%20response%20headers%3A%3Cbr%2F%3ERetry-After%3Cbr%2F%3ERateLimit%20(modern%20format%2C%20optional)%22%5D%0A%20%20%20%20DEFAULT%20--%3E%20BODY%5B%22Build%20ApiErrorResponse%3Cbr%2F%3E429%20%2F%20RATE_LIMIT_EXCEEDED%22%5D%0A%20%20%20%20DEFAULT%20--%3E%20LOC%5B%22Localize%20message%20via%3Cbr%2F%3EIErrorMessageLocalizer%22%5D%0A%20%20%20%20DEFAULT%20--%3E%20WRITER%5B%22ErrorResponseWriter%3Cbr%2F%3E.WriteResponseAsync()%22%5D%0A%0A%20%20%20%20style%20DEFAULT%20fill%3A%232563eb%2Ccolor%3A%23fff%0A%20%20%20%20style%20WRITER%20fill%3A%23059669%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[11]||(e[11]=[i(" Loading... ",-1)])]),_:1})),e[26]||(e[26]=o('<p>The <code>DefaultRateLimitResponseWriter</code>:</p><ul><li>Reads <code>MetadataName.RetryAfter</code> from the <code>RateLimitLease</code>.</li><li>Sets <code>Retry-After</code> header (always when metadata available).</li><li>Optionally sets the combined <code>RateLimit</code> header (IETF draft format) via <code>UseModernHeaderFormat</code>.</li><li>Optionally includes <code>retryAfter</code> in the JSON body via <code>IncludeRetryAfterInBody</code>.</li><li>Delegates body serialization to the shared <code>ErrorResponseWriter</code> (same format/field name logic).</li></ul><hr><h2 id="_13-openapi-swagger-integration" tabindex="-1">13. OpenAPI / Swagger Integration <a class="header-anchor" href="#_13-openapi-swagger-integration" aria-label="Permalink to &quot;13. OpenAPI / Swagger Integration&quot;">​</a></h2><p>The library provides two parallel packages for API documentation, split by framework generation.</p>',5)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-937",class:"mermaid",graph:"flowchart%20TD%0A%20%20%20%20subgraph%20Shared%20-%20Core%20Package%20internal%0A%20%20%20%20%20%20%20%20SCHEMA_GEN%5B%22ErrorResponseSchemaGenerator%22%5D%0A%20%20%20%20%20%20%20%20SCHEMA_GEN%20--%3E%20STD_SCHEMA%5B%22Standard%20JSON%20schema%3Cbr%2F%3E(code%2C%20message%2C%20fieldErrors%2C%20...)%22%5D%0A%20%20%20%20%20%20%20%20SCHEMA_GEN%20--%3E%20PD_SCHEMA%5B%22Problem%20Details%20schema%3Cbr%2F%3E(type%2C%20title%2C%20status%2C%20detail%2C%20instance)%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20ErrorLens.ErrorHandling.OpenApi%20-%20net9%2B%0A%20%20%20%20%20%20%20%20OA_EXT%5B%22AddErrorHandlingOpenApi()%22%5D%0A%20%20%20%20%20%20%20%20OA_EXT%20--%3E%20OA_TRANS%5B%22ErrorResponseOperationTransformer%3Cbr%2F%3E%3A%20IOpenApiOperationTransformer%22%5D%0A%20%20%20%20%20%20%20%20OA_TRANS%20--%3E%20SCHEMA_GEN%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20ErrorLens.ErrorHandling.Swashbuckle%20-%20net6-8%0A%20%20%20%20%20%20%20%20SW_EXT%5B%22AddErrorHandlingSwashbuckle()%22%5D%0A%20%20%20%20%20%20%20%20SW_EXT%20--%3E%20SW_FILTER%5B%22ErrorResponseOperationFilter%3Cbr%2F%3E%3A%20IOperationFilter%22%5D%0A%20%20%20%20%20%20%20%20SW_FILTER%20--%3E%20SCHEMA_GEN%0A%20%20%20%20end%0A%0A%20%20%20%20OA_TRANS%20--%3E%20OPS%5B%22Add%20error%20responses%3Cbr%2F%3Eto%20OpenAPI%20operations%22%5D%0A%20%20%20%20SW_FILTER%20--%3E%20OPS%0A%0A%20%20%20%20style%20SCHEMA_GEN%20fill%3A%232563eb%2Ccolor%3A%23fff%0A%20%20%20%20style%20OA_TRANS%20fill%3A%23059669%2Ccolor%3A%23fff%0A%20%20%20%20style%20SW_FILTER%20fill%3A%23d97706%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[12]||(e[12]=[i(" Loading... ",-1)])]),_:1})),e[27]||(e[27]=o('<p>Both integrations:</p><ul><li>Skip status codes already declared on the operation (e.g., via <code>[ProducesResponseType]</code>).</li><li>Add error response schemas for each status code in <code>OpenApiOptions.DefaultStatusCodes</code> (default: 400, 404, 500).</li><li>Choose between standard and Problem Details schemas based on <code>UseProblemDetailFormat</code>.</li><li>Use the configured <code>JsonFieldNamesOptions</code> for property names in the standard schema.</li></ul><hr><h2 id="_14-multi-targeting-strategy" tabindex="-1">14. Multi-Targeting Strategy <a class="header-anchor" href="#_14-multi-targeting-strategy" aria-label="Permalink to &quot;14. Multi-Targeting Strategy&quot;">​</a></h2>',4)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-967",class:"mermaid",graph:"graph%20TD%0A%20%20%20%20subgraph%20Core%20Package%20Targets%0A%20%20%20%20%20%20%20%20NET6%5B%22net6.0%22%5D%0A%20%20%20%20%20%20%20%20NET7%5B%22net7.0%22%5D%0A%20%20%20%20%20%20%20%20NET8%5B%22net8.0%22%5D%0A%20%20%20%20%20%20%20%20NET9%5B%22net9.0%22%5D%0A%20%20%20%20%20%20%20%20NET10%5B%22net10.0%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20Conditional%20Compilation%0A%20%20%20%20%20%20%20%20CC1%5B%22%23if%20NET7_0_OR_GREATER%3Cbr%2F%3EIRateLimitResponseWriter%3Cbr%2F%3EDefaultRateLimitResponseWriter%22%5D%0A%20%20%20%20%20%20%20%20CC2%5B%22%23if%20NET8_0_OR_GREATER%3Cbr%2F%3EErrorHandlingExceptionHandler%3Cbr%2F%3EIExceptionHandler%20registration%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20NET6%20-.-%3E%7Cexcluded%20from%7C%20CC1%0A%20%20%20%20NET6%20-.-%3E%7Cexcluded%20from%7C%20CC2%0A%20%20%20%20NET7%20--%3E%7Cincluded%20in%7C%20CC1%0A%20%20%20%20NET7%20-.-%3E%7Cexcluded%20from%7C%20CC2%0A%20%20%20%20NET8%20--%3E%7Cincluded%20in%7C%20CC1%0A%20%20%20%20NET8%20--%3E%7Cincluded%20in%7C%20CC2%0A%0A%20%20%20%20style%20CC1%20fill%3A%23059669%2Ccolor%3A%23fff%0A%20%20%20%20style%20CC2%20fill%3A%232563eb%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[13]||(e[13]=[i(" Loading... ",-1)])]),_:1})),e[28]||(e[28]=o('<table tabindex="0"><thead><tr><th>Feature</th><th>.NET 6</th><th>.NET 7</th><th>.NET 8+</th></tr></thead><tbody><tr><td>Middleware (<code>UseErrorHandling()</code>)</td><td>Required</td><td>Required</td><td>Optional</td></tr><tr><td><code>IExceptionHandler</code></td><td>N/A</td><td>N/A</td><td>Auto-registered</td></tr><tr><td>Rate limiting integration</td><td>N/A</td><td>Available</td><td>Available</td></tr></tbody></table><p>The <code>System.Threading.RateLimiting</code> NuGet package reference is conditionally excluded on <code>net6.0</code> via a <code>Condition</code> attribute in the <code>.csproj</code>.</p><hr><h2 id="_15-key-design-decisions" tabindex="-1">15. Key Design Decisions <a class="header-anchor" href="#_15-key-design-decisions" aria-label="Permalink to &quot;15. Key Design Decisions&quot;">​</a></h2><h3 id="_1-facade-pattern-over-mediator" tabindex="-1">1. Facade Pattern over Mediator <a class="header-anchor" href="#_1-facade-pattern-over-mediator" aria-label="Permalink to &quot;1. Facade Pattern over Mediator&quot;">​</a></h3><p>The <code>ErrorHandlingFacade</code> centralizes orchestration rather than using a mediator or event bus. This keeps the call path predictable, debuggable, and synchronous.</p><h3 id="_2-chain-of-responsibility-with-explicit-ordering" tabindex="-1">2. Chain of Responsibility with Explicit Ordering <a class="header-anchor" href="#_2-chain-of-responsibility-with-explicit-ordering" aria-label="Permalink to &quot;2. Chain of Responsibility with Explicit Ordering&quot;">​</a></h3><p>Handlers use a numeric <code>Order</code> property rather than framework-level ordering attributes. Built-in handlers use values 50-150, leaving <code>Order &lt; 50</code> for high-priority custom handlers and <code>Order &gt; 150</code> (default 1000) for standard custom handlers.</p><h3 id="_3-tryadd-for-idempotent-registration" tabindex="-1">3. TryAdd for Idempotent Registration <a class="header-anchor" href="#_3-tryadd-for-idempotent-registration" aria-label="Permalink to &quot;3. TryAdd for Idempotent Registration&quot;">​</a></h3><p>All DI registrations use <code>TryAddSingleton</code> or <code>TryAddEnumerable</code>, meaning:</p><ul><li>Calling <code>AddErrorHandling()</code> multiple times is safe.</li><li>Users can register their own <code>IErrorCodeMapper</code> (etc.) <strong>before</strong> calling <code>AddErrorHandling()</code> to override defaults.</li></ul><h3 id="_4-zero-cost-abstractions-for-optional-features" tabindex="-1">4. Zero-Cost Abstractions for Optional Features <a class="header-anchor" href="#_4-zero-cost-abstractions-for-optional-features" aria-label="Permalink to &quot;4. Zero-Cost Abstractions for Optional Features&quot;">​</a></h3><ul><li><strong>Localization:</strong> <code>NoOpErrorMessageLocalizer</code> is a pass-through; no allocation or lookup occurs.</li><li><strong>Telemetry:</strong> <code>Activity</code> tags are only set when <code>IsAllDataRequested == true</code> (no collector = no cost).</li><li><strong>Customizers:</strong> Empty <code>IEnumerable&lt;IApiErrorResponseCustomizer&gt;</code> means zero iterations.</li></ul><h3 id="_5-cached-serialization-options" tabindex="-1">5. Cached Serialization Options <a class="header-anchor" href="#_5-cached-serialization-options" aria-label="Permalink to &quot;5. Cached Serialization Options&quot;">​</a></h3><p><code>ErrorResponseWriter</code> creates its <code>JsonSerializerOptions</code> (including the custom <code>ApiErrorResponseConverter</code>) once at construction. This avoids per-request allocation.</p><h3 id="_6-security-by-default" tabindex="-1">6. Security by Default <a class="header-anchor" href="#_6-security-by-default" aria-label="Permalink to &quot;6. Security by Default&quot;">​</a></h3><ul><li>5xx errors in <code>DefaultFallbackHandler</code> always return <code>&quot;An unexpected error occurred&quot;</code> to prevent information disclosure.</li><li><code>BadRequestExceptionHandler</code> sanitizes messages containing framework-internal type names (<code>Microsoft.*</code>, <code>System.*</code>).</li></ul><h3 id="_7-static-metadata-cache" tabindex="-1">7. Static Metadata Cache <a class="header-anchor" href="#_7-static-metadata-cache" aria-label="Permalink to &quot;7. Static Metadata Cache&quot;">​</a></h3><p><code>ExceptionMetadataCache</code> uses a static <code>ConcurrentDictionary</code> to avoid repeated reflection on exception types. This is a process-lifetime cache that grows monotonically (appropriate for the bounded set of exception types in any application).</p><h3 id="_8-separate-openapi-packages-by-framework-generation" tabindex="-1">8. Separate OpenAPI Packages by Framework Generation <a class="header-anchor" href="#_8-separate-openapi-packages-by-framework-generation" aria-label="Permalink to &quot;8. Separate OpenAPI Packages by Framework Generation&quot;">​</a></h3><p>Rather than using conditional compilation within a single package, the library ships separate packages: <code>.OpenApi</code> for .NET 9+ and <code>.Swashbuckle</code> for .NET 6-8. Both share the internal <code>ErrorResponseSchemaGenerator</code>.</p><hr><h2 id="_16-public-interface-catalog" tabindex="-1">16. Public Interface Catalog <a class="header-anchor" href="#_16-public-interface-catalog" aria-label="Permalink to &quot;16. Public Interface Catalog&quot;">​</a></h2><h3 id="core-interfaces" tabindex="-1">Core Interfaces <a class="header-anchor" href="#core-interfaces" aria-label="Permalink to &quot;Core Interfaces&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Interface</th><th>Namespace</th><th>Purpose</th></tr></thead><tbody><tr><td><code>IApiExceptionHandler</code></td><td><code>Handlers</code></td><td>Chain of responsibility handler; implement to handle specific exception types</td></tr><tr><td><code>IFallbackApiExceptionHandler</code></td><td><code>Handlers</code></td><td>Catch-all handler when no specific handler matches</td></tr><tr><td><code>IErrorCodeMapper</code></td><td><code>Mappers</code></td><td>Maps exceptions to error code strings</td></tr><tr><td><code>IErrorMessageMapper</code></td><td><code>Mappers</code></td><td>Maps exceptions to human-readable messages</td></tr><tr><td><code>IHttpStatusMapper</code></td><td><code>Mappers</code></td><td>Maps exceptions to HTTP status codes</td></tr><tr><td><code>ILoggingService</code></td><td><code>Services</code></td><td>Logs exception handling events</td></tr><tr><td><code>ILoggingFilter</code></td><td><code>Services</code></td><td>Filters which exceptions should be logged</td></tr><tr><td><code>IApiErrorResponseCustomizer</code></td><td><code>Services</code></td><td>Global post-processing hook for all error responses</td></tr><tr><td><code>IErrorMessageLocalizer</code></td><td><code>Localization</code></td><td>Localizes error messages by error code</td></tr><tr><td><code>IProblemDetailFactory</code></td><td><code>ProblemDetails</code></td><td>Creates RFC 9457 responses from <code>ApiErrorResponse</code></td></tr><tr><td><code>IRateLimitResponseWriter</code></td><td><code>RateLimiting</code></td><td>Writes structured 429 responses (.NET 7+)</td></tr></tbody></table><h3 id="core-classes" tabindex="-1">Core Classes <a class="header-anchor" href="#core-classes" aria-label="Permalink to &quot;Core Classes&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Class</th><th>Namespace</th><th>Purpose</th></tr></thead><tbody><tr><td><code>AbstractApiExceptionHandler</code></td><td><code>Handlers</code></td><td>Base class with <code>Order =&gt; 1000</code> and <code>CreateResponse()</code> helper</td></tr><tr><td><code>ErrorHandlingFacade</code></td><td><code>Services</code></td><td>Central orchestrator for the entire pipeline</td></tr><tr><td><code>ErrorResponseWriter</code></td><td><code>Integration</code></td><td>Writes JSON/Problem Details to <code>HttpContext.Response</code></td></tr><tr><td><code>ErrorHandlingMiddleware</code></td><td><code>Integration</code></td><td><code>IMiddleware</code> for .NET 6/7</td></tr><tr><td><code>ErrorHandlingExceptionHandler</code></td><td><code>Integration</code></td><td><code>IExceptionHandler</code> for .NET 8+</td></tr><tr><td><code>ApiErrorResponse</code></td><td><code>Models</code></td><td>Primary error response model</td></tr><tr><td><code>ApiFieldError</code></td><td><code>Models</code></td><td>Field-level validation error</td></tr><tr><td><code>ApiGlobalError</code></td><td><code>Models</code></td><td>Class-level validation error</td></tr><tr><td><code>ApiParameterError</code></td><td><code>Models</code></td><td>Method parameter validation error</td></tr><tr><td><code>ProblemDetailResponse</code></td><td><code>ProblemDetails</code></td><td>RFC 9457 response model</td></tr><tr><td><code>ErrorHandlingActivitySource</code></td><td><code>Telemetry</code></td><td>Static <code>ActivitySource</code> for OTel tracing</td></tr><tr><td><code>ApiErrorResponseConverter</code></td><td><code>Serialization</code></td><td>Custom JSON converter for configurable field names</td></tr></tbody></table><h3 id="extension-methods" tabindex="-1">Extension Methods <a class="header-anchor" href="#extension-methods" aria-label="Permalink to &quot;Extension Methods&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Method</th><th>Class</th><th>Purpose</th></tr></thead><tbody><tr><td><code>AddErrorHandling()</code></td><td><code>ServiceCollectionExtensions</code></td><td>Register all core services</td></tr><tr><td><code>AddApiExceptionHandler&lt;T&gt;()</code></td><td><code>ServiceCollectionExtensions</code></td><td>Register custom exception handler</td></tr><tr><td><code>AddErrorResponseCustomizer&lt;T&gt;()</code></td><td><code>ServiceCollectionExtensions</code></td><td>Register response customizer</td></tr><tr><td><code>AddErrorHandlingLocalization&lt;T&gt;()</code></td><td><code>ServiceCollectionExtensions</code></td><td>Opt into IStringLocalizer-based localization</td></tr><tr><td><code>UseErrorHandling()</code></td><td><code>ApplicationBuilderExtensions</code></td><td>Add middleware to pipeline (required .NET 6/7)</td></tr><tr><td><code>AddYamlErrorHandling()</code></td><td><code>ConfigurationBuilderExtensions</code></td><td>Add YAML configuration source</td></tr><tr><td><code>AddErrorHandlingOpenApi()</code></td><td><code>OpenApiServiceCollectionExtensions</code></td><td>Add .NET 9+ OpenAPI schemas</td></tr><tr><td><code>AddErrorHandlingSwashbuckle()</code></td><td><code>SwaggerServiceCollectionExtensions</code></td><td>Add Swashbuckle operation filter</td></tr></tbody></table><h3 id="attributes" tabindex="-1">Attributes <a class="header-anchor" href="#attributes" aria-label="Permalink to &quot;Attributes&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Attribute</th><th>Target</th><th>Purpose</th></tr></thead><tbody><tr><td><code>[ResponseErrorCode(&quot;CODE&quot;)]</code></td><td>Class (Exception)</td><td>Override error code for an exception type</td></tr><tr><td><code>[ResponseStatus(HttpStatusCode)]</code></td><td>Class (Exception)</td><td>Override HTTP status for an exception type</td></tr><tr><td><code>[ResponseErrorProperty]</code></td><td>Property (on Exception)</td><td>Include property value in error response JSON</td></tr></tbody></table>',31))])}const T=l(A,[["render",E]]);export{m as __pageData,T as default};
