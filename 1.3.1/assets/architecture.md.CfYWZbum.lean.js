import{_ as l,C as c,o as r,c as p,a2 as o,b as d,w as t,a as i,E as n,a3 as s}from"./chunks/framework.-Q5tCgKN.js";const m=JSON.parse('{"title":"ErrorLens.ErrorHandling -- Architecture Guide","description":"","frontmatter":{},"headers":[],"relativePath":"architecture.md","filePath":"architecture.md"}'),A={name:"architecture.md"};function E(g,e,h,u,C,f){const a=c("Mermaid");return r(),p("div",null,[e[14]||(e[14]=o("",9)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-104",class:"mermaid",graph:"graph%20TD%0A%20%20%20%20subgraph%20Core%20Package%0A%20%20%20%20%20%20%20%20CORE%5B%22ErrorLens.ErrorHandling%3Cbr%2F%3E%3Ci%3Enet6.0%20-%20net10.0%3C%2Fi%3E%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20OpenAPI%20Packages%0A%20%20%20%20%20%20%20%20OPENAPI%5B%22ErrorLens.ErrorHandling.OpenApi%3Cbr%2F%3E%3Ci%3Enet9.0%20-%20net10.0%3C%2Fi%3E%3Cbr%2F%3EMicrosoft.AspNetCore.OpenApi%22%5D%0A%20%20%20%20%20%20%20%20SWASH%5B%22ErrorLens.ErrorHandling.Swashbuckle%3Cbr%2F%3E%3Ci%3Enet6.0%20-%20net8.0%3C%2Fi%3E%3Cbr%2F%3ESwashbuckle.AspNetCore.SwaggerGen%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20OPENAPI%20--%3E%7CProjectReference%7C%20CORE%0A%20%20%20%20SWASH%20--%3E%7CProjectReference%7C%20CORE%0A%0A%20%20%20%20CORE%20-.-%3E%7CInternalsVisibleTo%7C%20OPENAPI%0A%20%20%20%20CORE%20-.-%3E%7CInternalsVisibleTo%7C%20SWASH%0A%0A%20%20%20%20style%20CORE%20fill%3A%232563eb%2Ccolor%3A%23fff%2Cstroke%3A%231e40af%0A%20%20%20%20style%20OPENAPI%20fill%3A%23059669%2Ccolor%3A%23fff%2Cstroke%3A%23047857%0A%20%20%20%20style%20SWASH%20fill%3A%23d97706%2Ccolor%3A%23fff%2Cstroke%3A%23b45309%0A"})]),fallback:t(()=>[...e[0]||(e[0]=[i(" Loading... ",-1)])]),_:1})),e[15]||(e[15]=o("",6)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-166",class:"mermaid",graph:"graph%20TB%0A%20%20%20%20REQ%5B%22Incoming%20HTTP%20Request%22%5D%20--%3E%20MW%7B%22Middleware%20%2F%20IExceptionHandler%22%7D%0A%0A%20%20%20%20MW%20--%3E%7CException%20caught%7C%20FACADE%5B%22ErrorHandlingFacade%22%5D%0A%0A%20%20%20%20FACADE%20--%3E%20CHAIN%5B%22Handler%20Chain%3Cbr%2F%3E(IApiExceptionHandler%5B%5D)%22%5D%0A%20%20%20%20CHAIN%20--%3E%7CNo%20handler%20matched%7C%20FB%5B%22IFallbackApiExceptionHandler%3Cbr%2F%3E(DefaultFallbackHandler)%22%5D%0A%20%20%20%20CHAIN%20--%3E%7CHandler%20matched%7C%20RESP%5B%22ApiErrorResponse%22%5D%0A%20%20%20%20FB%20--%3E%20RESP%0A%0A%20%20%20%20FACADE%20--%3E%20CUST%5B%22IApiErrorResponseCustomizer%5B%5D%22%5D%0A%20%20%20%20CUST%20--%3E%20RESP2%5B%22Customized%20Response%22%5D%0A%0A%20%20%20%20FACADE%20--%3E%20LOG%5B%22ILoggingService%22%5D%0A%20%20%20%20FACADE%20--%3E%20LOC%5B%22IErrorMessageLocalizer%22%5D%0A%20%20%20%20FACADE%20--%3E%20TEL%5B%22ActivitySource%3Cbr%2F%3E(Telemetry)%22%5D%0A%0A%20%20%20%20RESP2%20--%3E%20WRITER%5B%22ErrorResponseWriter%22%5D%0A%0A%20%20%20%20WRITER%20--%3E%7CUseProblemDetailFormat%3Dfalse%7C%20JSON%5B%22application%2Fjson%3Cbr%2F%3EApiErrorResponse%22%5D%0A%20%20%20%20WRITER%20--%3E%7CUseProblemDetailFormat%3Dtrue%7C%20PD%5B%22application%2Fproblem%2Bjson%3Cbr%2F%3EProblemDetailResponse%22%5D%0A%0A%20%20%20%20JSON%20--%3E%20CLIENT%5B%22HTTP%20Response%22%5D%0A%20%20%20%20PD%20--%3E%20CLIENT%0A%0A%20%20%20%20style%20FACADE%20fill%3A%232563eb%2Ccolor%3A%23fff%0A%20%20%20%20style%20CHAIN%20fill%3A%237c3aed%2Ccolor%3A%23fff%0A%20%20%20%20style%20WRITER%20fill%3A%23059669%2Ccolor%3A%23fff%0A%20%20%20%20style%20MW%20fill%3A%23dc2626%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[1]||(e[1]=[i(" Loading... ",-1)])]),_:1})),e[16]||(e[16]=o("",4)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-177",class:"mermaid",graph:"flowchart%20TD%0A%20%20%20%20A%5B%22Exception%20thrown%20in%3Cbr%2F%3Econtroller%20%2F%20endpoint%22%5D%20--%3E%20B%7B%22Options.Enabled%3F%22%7D%0A%20%20%20%20B%20--%3E%7Cfalse%7C%20B1%5B%22Rethrow%20via%3Cbr%2F%3EExceptionDispatchInfo%22%5D%0A%20%20%20%20B%20--%3E%7Ctrue%7C%20C%5B%22Start%20Activity%3Cbr%2F%3E(ErrorLens.HandleException)%22%5D%0A%0A%20%20%20%20C%20--%3E%20D%5B%22Iterate%20handlers%3Cbr%2F%3Esorted%20by%20Order%20ASC%22%5D%0A%20%20%20%20D%20--%3E%20E%7B%22handler.CanHandle(ex)%3F%22%7D%0A%20%20%20%20E%20--%3E%7Cyes%7C%20F%5B%22handler.Handle(ex)%3Cbr%2F%3Ereturns%20ApiErrorResponse%22%5D%0A%20%20%20%20E%20--%3E%7Cno%2C%20next%20handler%7C%20D%0A%20%20%20%20E%20--%3E%7Cno%20handlers%20match%7C%20G%5B%22fallbackHandler.Handle(ex)%22%5D%0A%0A%20%20%20%20F%20--%3E%20H%7B%22HttpStatusInJsonResponse%3F%22%7D%0A%20%20%20%20G%20--%3E%20H%0A%20%20%20%20H%20--%3E%7Ctrue%7C%20H1%5B%22Set%20response.Status%20%3D%20statusCode%22%5D%0A%20%20%20%20H%20--%3E%7Cfalse%7C%20I%5B%22Apply%20Customizers%22%5D%0A%20%20%20%20H1%20--%3E%20I%0A%0A%20%20%20%20I%20--%3E%20J%5B%22foreach%20customizer%3A%3Cbr%2F%3Ecustomizer.Customize(response)%22%5D%0A%20%20%20%20J%20--%3E%20K%5B%22LoggingService.LogException()%22%5D%0A%0A%20%20%20%20K%20--%3E%20K1%7B%22ILoggingFilter%5B%5D.ShouldLog()%3F%22%7D%0A%20%20%20%20K1%20--%3E%7Cfiltered%20out%7C%20L%5B%22Skip%20logging%22%5D%0A%20%20%20%20K1%20--%3E%7Callowed%7C%20K2%7B%22ExceptionLogging%20level%3F%22%7D%0A%20%20%20%20K2%20--%3E%7CNone%7C%20L%0A%20%20%20%20K2%20--%3E%7CMessageOnly%7C%20K3%5B%22Log%20code%20%2B%20message%22%5D%0A%20%20%20%20K2%20--%3E%7CWithStacktrace%7C%20K4%5B%22Log%20code%20%2B%20message%20%2B%20exception%22%5D%0A%0A%20%20%20%20L%20--%3E%20M%5B%22Localize%20messages%3Cbr%2F%3E(IErrorMessageLocalizer)%22%5D%0A%20%20%20%20K3%20--%3E%20M%0A%20%20%20%20K4%20--%3E%20M%0A%0A%20%20%20%20M%20--%3E%20N%5B%22Enrich%20Activity%20tags%3Cbr%2F%3E(error.code%2C%20error.type%2C%3Cbr%2F%3Ehttp.response.status_code)%22%5D%0A%20%20%20%20N%20--%3E%20O%5B%22Add%20OTel%20exception%20event%22%5D%0A%0A%20%20%20%20O%20--%3E%20P%5B%22ErrorResponseWriter%3Cbr%2F%3E.WriteResponseAsync()%22%5D%0A%0A%20%20%20%20P%20--%3E%20Q%7B%22Response.HasStarted%3F%22%7D%0A%20%20%20%20Q%20--%3E%7Cyes%7C%20R%5B%22Return%20(no-op)%22%5D%0A%20%20%20%20Q%20--%3E%7Cno%7C%20S%7B%22UseProblemDetailFormat%3F%22%7D%0A%0A%20%20%20%20S%20--%3E%7Cfalse%7C%20T%5B%22Serialize%20ApiErrorResponse%3Cbr%2F%3Evia%20ApiErrorResponseConverter%3Cbr%2F%3EContent-Type%3A%20application%2Fjson%22%5D%0A%20%20%20%20S%20--%3E%7Ctrue%7C%20U%5B%22ProblemDetailFactory%3Cbr%2F%3E.CreateFromApiError()%3Cbr%2F%3EContent-Type%3A%20application%2Fproblem%2Bjson%22%5D%0A%0A%20%20%20%20T%20--%3E%20V%5B%22HTTP%20Response%20written%22%5D%0A%20%20%20%20U%20--%3E%20V%0A%0A%20%20%20%20style%20A%20fill%3A%23dc2626%2Ccolor%3A%23fff%0A%20%20%20%20style%20C%20fill%3A%237c3aed%2Ccolor%3A%23fff%0A%20%20%20%20style%20F%20fill%3A%23059669%2Ccolor%3A%23fff%0A%20%20%20%20style%20G%20fill%3A%23d97706%2Ccolor%3A%23fff%0A%20%20%20%20style%20V%20fill%3A%232563eb%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[2]||(e[2]=[i(" Loading... ",-1)])]),_:1})),e[17]||(e[17]=o("",5)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-205",class:"mermaid",graph:"graph%20TD%0A%20%20%20%20subgraph%20Entry%20Points%0A%20%20%20%20%20%20%20%20AEH1%5B%22AddErrorHandling()%22%5D%0A%20%20%20%20%20%20%20%20AEH2%5B%22AddErrorHandling(Action%26lt%3BOptions%26gt%3B)%22%5D%0A%20%20%20%20%20%20%20%20AEH3%5B%22AddErrorHandling(IConfiguration)%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20AEH1%20--%3E%20AEH2%0A%20%20%20%20AEH2%20--%3E%20BIND%5B%22Bind%20'ErrorHandling'%20section%3Cbr%2F%3E%2B%20apply%20Action%20configure%22%5D%0A%20%20%20%20AEH3%20--%3E%20BIND3%5B%22Bind%20IConfiguration%20section%22%5D%0A%20%20%20%20BIND%20--%3E%20RCS%5B%22RegisterCoreServices()%22%5D%0A%20%20%20%20BIND3%20--%3E%20RCS%0A%0A%20%20%20%20subgraph%20RegisterCoreServices%0A%20%20%20%20%20%20%20%20direction%20TB%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20VAL%5B%22IValidateOptions%26lt%3BErrorHandlingOptions%26gt%3B%3Cbr%2F%3EErrorHandlingOptionsValidator%22%5D%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20ECM%5B%22IErrorCodeMapper%20-%3E%20ErrorCodeMapper%22%5D%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20EMM%5B%22IErrorMessageMapper%20-%3E%20ErrorMessageMapper%22%5D%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20HSM%5B%22IHttpStatusMapper%20-%3E%20HttpStatusMapper%22%5D%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20LS%5B%22ILoggingService%20-%3E%20LoggingService%22%5D%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20LOC%5B%22IErrorMessageLocalizer%20-%3E%20NoOpErrorMessageLocalizer%22%5D%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20FBH%5B%22IFallbackApiExceptionHandler%20-%3E%20DefaultFallbackHandler%22%5D%0A%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20H1%5B%22IApiExceptionHandler%3A%206%20built-in%20handlers%22%5D%0A%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20ABO%5B%22ApiBehaviorOptions%3Cbr%2F%3E(conditional%20ModelState%20override)%22%5D%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20FAC%5B%22ErrorHandlingFacade%22%5D%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20PDF%5B%22IProblemDetailFactory%20-%3E%20ProblemDetailFactory%22%5D%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20ERW%5B%22ErrorResponseWriter%22%5D%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20MWR%5B%22ErrorHandlingMiddleware%22%5D%0A%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20RL%5B%22IRateLimitResponseWriter%3Cbr%2F%3EDefaultRateLimitResponseWriter%3Cbr%2F%3E%3Ci%3E(NET7_0_OR_GREATER)%3C%2Fi%3E%22%5D%0A%20%20%20%20%20%20%20%20RCS%20--%3E%20EXH%5B%22IExceptionHandler%3Cbr%2F%3EErrorHandlingExceptionHandler%3Cbr%2F%3E%3Ci%3E(NET8_0_OR_GREATER)%3C%2Fi%3E%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20User%20Extension%20Points%0A%20%20%20%20%20%20%20%20UH%5B%22AddApiExceptionHandler%26lt%3BT%26gt%3B()%22%5D%0A%20%20%20%20%20%20%20%20UC%5B%22AddErrorResponseCustomizer%26lt%3BT%26gt%3B()%22%5D%0A%20%20%20%20%20%20%20%20UL%5B%22AddErrorHandlingLocalization%26lt%3BT%26gt%3B()%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20UH%20--%3E%7CTryAddEnumerable%7C%20H1%0A%20%20%20%20UC%20--%3E%7CTryAddEnumerable%7C%20CUS%5B%22IApiErrorResponseCustomizer%22%5D%0A%20%20%20%20UL%20--%3E%7CReplace%7C%20LOC2%5B%22StringLocalizerErrorMessageLocalizer%26lt%3BT%26gt%3B%22%5D%0A%0A%20%20%20%20style%20RCS%20fill%3A%232563eb%2Ccolor%3A%23fff%0A%20%20%20%20style%20FAC%20fill%3A%237c3aed%2Ccolor%3A%23fff%0A%20%20%20%20style%20ERW%20fill%3A%23059669%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[3]||(e[3]=[i(" Loading... ",-1)])]),_:1})),e[18]||(e[18]=o("",6)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-280",class:"mermaid",graph:"graph%20LR%0A%20%20%20%20EX%5B%22Exception%22%5D%20--%3E%20AGG%0A%0A%20%20%20%20subgraph%20Handler%20Chain%20-%20sorted%20by%20Order%0A%20%20%20%20%20%20%20%20AGG%5B%22AggregateExceptionHandler%3Cbr%2F%3EOrder%3A%2050%22%5D%0A%20%20%20%20%20%20%20%20MSV%5B%22ModelStateValidation%3Cbr%2F%3EExceptionHandler%3Cbr%2F%3EOrder%3A%2090%22%5D%0A%20%20%20%20%20%20%20%20VEH%5B%22ValidationException%3Cbr%2F%3EHandler%3Cbr%2F%3EOrder%3A%20100%22%5D%0A%20%20%20%20%20%20%20%20JEH%5B%22JsonException%3Cbr%2F%3EHandler%3Cbr%2F%3EOrder%3A%20120%22%5D%0A%20%20%20%20%20%20%20%20TMH%5B%22TypeMismatch%3Cbr%2F%3EExceptionHandler%3Cbr%2F%3EOrder%3A%20130%22%5D%0A%20%20%20%20%20%20%20%20BRH%5B%22BadRequest%3Cbr%2F%3EExceptionHandler%3Cbr%2F%3EOrder%3A%20150%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20AGG%20--%3E%7CCanHandle%3Dfalse%7C%20MSV%0A%20%20%20%20MSV%20--%3E%7CCanHandle%3Dfalse%7C%20VEH%0A%20%20%20%20VEH%20--%3E%7CCanHandle%3Dfalse%7C%20JEH%0A%20%20%20%20JEH%20--%3E%7CCanHandle%3Dfalse%7C%20TMH%0A%20%20%20%20TMH%20--%3E%7CCanHandle%3Dfalse%7C%20BRH%0A%20%20%20%20BRH%20--%3E%7CCanHandle%3Dfalse%7C%20FB%5B%22DefaultFallbackHandler%3Cbr%2F%3E(catch-all)%22%5D%0A%0A%20%20%20%20style%20AGG%20fill%3A%237c3aed%2Ccolor%3A%23fff%0A%20%20%20%20style%20FB%20fill%3A%23d97706%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[4]||(e[4]=[i(" Loading... ",-1)])]),_:1})),e[19]||(e[19]=o("",6)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-436",class:"mermaid",graph:"flowchart%20TD%0A%20%20%20%20subgraph%20Configuration%20Sources%0A%20%20%20%20%20%20%20%20APS%5B%22appsettings.json%3Cbr%2F%3ESection%3A%20'ErrorHandling'%22%5D%0A%20%20%20%20%20%20%20%20YAML%5B%22errorhandling.yml%3Cbr%2F%3E(via%20AddYamlErrorHandling)%22%5D%0A%20%20%20%20%20%20%20%20INLINE%5B%22Inline%20Action%26lt%3BErrorHandlingOptions%26gt%3B%22%5D%0A%20%20%20%20%20%20%20%20ICONFIG%5B%22IConfiguration%20binding%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20APS%20--%3E%20MERGE%5B%22IConfiguration%3Cbr%2F%3Emerged%20key-value%20store%22%5D%0A%20%20%20%20YAML%20--%3E%20MERGE%0A%20%20%20%20MERGE%20--%3E%20BIND%5B%22Options%20binding%20pipeline%22%5D%0A%20%20%20%20ICONFIG%20--%3E%20BIND%0A%20%20%20%20INLINE%20--%3E%20BIND%0A%0A%20%20%20%20BIND%20--%3E%20OPT%5B%22ErrorHandlingOptions%22%5D%0A%0A%20%20%20%20OPT%20--%3E%20VAL%5B%22ErrorHandlingOptionsValidator%3Cbr%2F%3E(IValidateOptions)%22%5D%0A%20%20%20%20VAL%20--%3E%7CFail%7C%20STARTUP_ERR%5B%22OptionsValidationException%3Cbr%2F%3Eat%20first%20resolve%22%5D%0A%20%20%20%20VAL%20--%3E%7CPass%7C%20RESOLVED%5B%22Validated%20options%3Cbr%2F%3Eavailable%20via%20IOptions%22%5D%0A%0A%20%20%20%20style%20OPT%20fill%3A%232563eb%2Ccolor%3A%23fff%0A%20%20%20%20style%20VAL%20fill%3A%23dc2626%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[5]||(e[5]=[i(" Loading... ",-1)])]),_:1})),e[20]||(e[20]=o("",10)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-766",class:"mermaid",graph:"classDiagram%0A%20%20%20%20class%20ResponseErrorCodeAttribute%20%7B%0A%20%20%20%20%20%20%20%20%2Bstring%20Code%0A%20%20%20%20%20%20%20%20AttributeUsage%3A%20Class%0A%20%20%20%20%7D%0A%0A%20%20%20%20class%20ResponseStatusAttribute%20%7B%0A%20%20%20%20%20%20%20%20%2BHttpStatusCode%20StatusCode%0A%20%20%20%20%20%20%20%20AttributeUsage%3A%20Class%0A%20%20%20%20%7D%0A%0A%20%20%20%20class%20ResponseErrorPropertyAttribute%20%7B%0A%20%20%20%20%20%20%20%20%2Bstring%20Name%0A%20%20%20%20%20%20%20%20%2Bbool%20IncludeIfNull%0A%20%20%20%20%20%20%20%20AttributeUsage%3A%20Property%0A%20%20%20%20%7D%0A%0A%20%20%20%20class%20ExceptionMetadataCache%20%7B%0A%20%20%20%20%20%20%20%20-ConcurrentDictionary~Type%2C%20ExceptionMetadata~%20_cache%0A%20%20%20%20%20%20%20%20%2BGetMetadata(Type)%20ExceptionMetadata%0A%20%20%20%20%7D%0A%0A%20%20%20%20class%20ExceptionMetadata%20%7B%0A%20%20%20%20%20%20%20%20%2Bstring%20ErrorCode%0A%20%20%20%20%20%20%20%20%2BHttpStatusCode%20StatusCode%0A%20%20%20%20%20%20%20%20%2BIReadOnlyList~PropertyMetadata~%20Properties%0A%20%20%20%20%7D%0A%0A%20%20%20%20class%20PropertyMetadata%20%7B%0A%20%20%20%20%20%20%20%20%2BPropertyInfo%20Property%0A%20%20%20%20%20%20%20%20%2Bstring%20Name%0A%20%20%20%20%20%20%20%20%2Bbool%20IncludeIfNull%0A%20%20%20%20%7D%0A%0A%20%20%20%20ExceptionMetadataCache%20--%3E%20ExceptionMetadata%20%3A%20caches%0A%20%20%20%20ExceptionMetadata%20--%3E%20PropertyMetadata%20%3A%20contains%0A%20%20%20%20ResponseErrorCodeAttribute%20..%3E%20ExceptionMetadata%20%3A%20read%20by%20cache%0A%20%20%20%20ResponseStatusAttribute%20..%3E%20ExceptionMetadata%20%3A%20read%20by%20cache%0A%20%20%20%20ResponseErrorPropertyAttribute%20..%3E%20PropertyMetadata%20%3A%20read%20by%20cache%0A"})]),fallback:t(()=>[...e[6]||(e[6]=[i(" Loading... ",-1)])]),_:1})),e[21]||(e[21]=o("",6)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-797",class:"mermaid",graph:"flowchart%20LR%0A%20%20%20%20subgraph%20ErrorResponseWriter%0A%20%20%20%20%20%20%20%20direction%20TB%0A%20%20%20%20%20%20%20%20OPTS%5B%22JsonSerializerOptions%3Cbr%2F%3E(cached%20at%20construction)%22%5D%0A%20%20%20%20%20%20%20%20CONV%5B%22ApiErrorResponseConverter%3Cbr%2F%3E(uses%20JsonFieldNamesOptions)%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20OPTS%20--%3E%20CONV%0A%0A%20%20%20%20CONV%20--%3E%20WRITE%5B%22Custom%20Utf8JsonWriter%20logic%22%5D%0A%0A%20%20%20%20WRITE%20--%3E%20CODE%5B%22Write%20'code'%20(always)%22%5D%0A%20%20%20%20WRITE%20--%3E%20MSG%5B%22Write%20'message'%20(if%20non-null)%22%5D%0A%20%20%20%20WRITE%20--%3E%20STATUS%5B%22Write%20'status'%20(if%20non-zero)%22%5D%0A%20%20%20%20WRITE%20--%3E%20FE%5B%22Write%20'fieldErrors'%20array%22%5D%0A%20%20%20%20WRITE%20--%3E%20GE%5B%22Write%20'globalErrors'%20array%22%5D%0A%20%20%20%20WRITE%20--%3E%20PE%5B%22Write%20'parameterErrors'%20array%22%5D%0A%20%20%20%20WRITE%20--%3E%20PROPS%5B%22Write%20extension%20properties%3Cbr%2F%3E(skip%20collisions%20with%20built-in)%22%5D%0A%0A%20%20%20%20style%20CONV%20fill%3A%232563eb%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[7]||(e[7]=[i(" Loading... ",-1)])]),_:1})),e[22]||(e[22]=o("",5)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-830",class:"mermaid",graph:"flowchart%20TD%0A%20%20%20%20AER%5B%22ApiErrorResponse%22%5D%20--%3E%20FACTORY%5B%22ProblemDetailFactory%22%5D%0A%0A%20%20%20%20FACTORY%20--%3E%20PDR%5B%22ProblemDetailResponse%22%5D%0A%0A%20%20%20%20PDR%20--%3E%20TYPE%5B%22type%3A%20prefix%20%2B%20kebab-code%3Cbr%2F%3Ee.g.%2C%20https%3A%2F%2Fexample.com%2Ferrors%2Fvalidation-failed%22%5D%0A%20%20%20%20PDR%20--%3E%20TITLE%5B%22title%3A%20HTTP%20reason%20phrase%3Cbr%2F%3Ee.g.%2C%20'Bad%20Request'%22%5D%0A%20%20%20%20PDR%20--%3E%20STAT%5B%22status%3A%20400%22%5D%0A%20%20%20%20PDR%20--%3E%20DETAIL%5B%22detail%3A%20error%20message%22%5D%0A%20%20%20%20PDR%20--%3E%20INST%5B%22instance%3A%20request%20path%3Cbr%2F%3E(set%20by%20ErrorResponseWriter)%22%5D%0A%0A%20%20%20%20PDR%20--%3E%20EXT%5B%22Extensions%20dictionary%22%5D%0A%20%20%20%20EXT%20--%3E%20EXTFE%5B%22fieldErrors%20(if%20any)%22%5D%0A%20%20%20%20EXT%20--%3E%20EXTGE%5B%22globalErrors%20(if%20any)%22%5D%0A%20%20%20%20EXT%20--%3E%20EXTPE%5B%22parameterErrors%20(if%20any)%22%5D%0A%20%20%20%20EXT%20--%3E%20EXTCODE%5B%22code%3A%20original%20error%20code%22%5D%0A%20%20%20%20EXT%20--%3E%20EXTCUST%5B%22custom%20properties%20from%20ResponseErrorProperty%22%5D%0A%0A%20%20%20%20style%20FACTORY%20fill%3A%232563eb%2Ccolor%3A%23fff%0A%20%20%20%20style%20PDR%20fill%3A%23059669%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[8]||(e[8]=[i(" Loading... ",-1)])]),_:1})),e[23]||(e[23]=o("",3)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-838",class:"mermaid",graph:"flowchart%20TD%0A%20%20%20%20subgraph%20Default%20Path%20-%20no%20localization%0A%20%20%20%20%20%20%20%20NOOP%5B%22NoOpErrorMessageLocalizer%3Cbr%2F%3E(returns%20defaultMessage%20unchanged)%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20Opted-in%20Path%0A%20%20%20%20%20%20%20%20CALL%5B%22AddErrorHandlingLocalization%26lt%3BTResource%26gt%3B()%22%5D%0A%20%20%20%20%20%20%20%20CALL%20--%3E%20REP%5B%22Replace%20IErrorMessageLocalizer%3Cbr%2F%3Ewith%20StringLocalizerErrorMessageLocalizer%26lt%3BT%26gt%3B%22%5D%0A%20%20%20%20%20%20%20%20REP%20--%3E%20SL%5B%22IStringLocalizer%26lt%3BTResource%26gt%3B%22%5D%0A%20%20%20%20%20%20%20%20SL%20--%3E%20RESX%5B%22*.resx%20resource%20files%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20FACADE%5B%22ErrorHandlingFacade%22%5D%20--%3E%20LOC%7B%22IErrorMessageLocalizer%22%7D%0A%20%20%20%20LOC%20--%3E%7Cdefault%7C%20NOOP%0A%20%20%20%20LOC%20--%3E%7Copted%20in%7C%20REP%0A%0A%20%20%20%20LOC%20--%3E%20L1%5B%22Localize%20response.Message%3Cbr%2F%3Eusing%20response.Code%20as%20key%22%5D%0A%20%20%20%20LOC%20--%3E%20L2%5B%22Localize%20each%20fieldError.Message%22%5D%0A%20%20%20%20LOC%20--%3E%20L3%5B%22Localize%20each%20globalError.Message%22%5D%0A%20%20%20%20LOC%20--%3E%20L4%5B%22Localize%20each%20parameterError.Message%22%5D%0A%0A%20%20%20%20style%20FACADE%20fill%3A%232563eb%2Ccolor%3A%23fff%0A%20%20%20%20style%20LOC%20fill%3A%237c3aed%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[9]||(e[9]=[i(" Loading... ",-1)])]),_:1})),e[24]||(e[24]=o("",5)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-866",class:"mermaid",graph:"flowchart%20LR%0A%20%20%20%20FACADE%5B%22ErrorHandlingFacade%3Cbr%2F%3E.HandleException()%22%5D%20--%3E%20ACT%5B%22ActivitySource.StartActivity%3Cbr%2F%3E('ErrorLens.HandleException')%22%5D%0A%0A%20%20%20%20ACT%20--%3E%20TAG1%5B%22Tag%3A%20error.code%22%5D%0A%20%20%20%20ACT%20--%3E%20TAG2%5B%22Tag%3A%20error.type%3Cbr%2F%3E(exception%20FullName)%22%5D%0A%20%20%20%20ACT%20--%3E%20TAG3%5B%22Tag%3A%20http.response.status_code%22%5D%0A%20%20%20%20ACT%20--%3E%20EVT%5B%22Event%3A%20'exception'%3Cbr%2F%3Eexception.type%3Cbr%2F%3Eexception.message%3Cbr%2F%3Eexception.stacktrace%22%5D%0A%20%20%20%20ACT%20--%3E%20STAT%5B%22SetStatus(Error%2C%20message)%22%5D%0A%0A%20%20%20%20OTEL%5B%22OpenTelemetry%20Collector%3Cbr%2F%3E(if%20configured)%22%5D%20-.-%3E%7Clistens%20to%7C%20SRC%5B%22ActivitySource%3A%3Cbr%2F%3E'ErrorLens.ErrorHandling'%22%5D%0A%0A%20%20%20%20style%20ACT%20fill%3A%237c3aed%2Ccolor%3A%23fff%0A%20%20%20%20style%20SRC%20fill%3A%23059669%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[10]||(e[10]=[i(" Loading... ",-1)])]),_:1})),e[25]||(e[25]=o("",5)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-899",class:"mermaid",graph:"flowchart%20TD%0A%20%20%20%20RL_MW%5B%22ASP.NET%20Core%3Cbr%2F%3ERate%20Limiter%20Middleware%22%5D%20--%3E%7COnRejected%20callback%7C%20IRLRW%5B%22IRateLimitResponseWriter%22%5D%0A%0A%20%20%20%20IRLRW%20--%3E%20DEFAULT%5B%22DefaultRateLimitResponseWriter%22%5D%0A%0A%20%20%20%20DEFAULT%20--%3E%20LEASE%5B%22Extract%20RetryAfter%3Cbr%2F%3Efrom%20RateLimitLease%20metadata%22%5D%0A%20%20%20%20DEFAULT%20--%3E%20HEADERS%5B%22Set%20response%20headers%3A%3Cbr%2F%3ERetry-After%3Cbr%2F%3ERateLimit%20(modern%20format%2C%20optional)%22%5D%0A%20%20%20%20DEFAULT%20--%3E%20BODY%5B%22Build%20ApiErrorResponse%3Cbr%2F%3E429%20%2F%20RATE_LIMIT_EXCEEDED%22%5D%0A%20%20%20%20DEFAULT%20--%3E%20LOC%5B%22Localize%20message%20via%3Cbr%2F%3EIErrorMessageLocalizer%22%5D%0A%20%20%20%20DEFAULT%20--%3E%20WRITER%5B%22ErrorResponseWriter%3Cbr%2F%3E.WriteResponseAsync()%22%5D%0A%0A%20%20%20%20style%20DEFAULT%20fill%3A%232563eb%2Ccolor%3A%23fff%0A%20%20%20%20style%20WRITER%20fill%3A%23059669%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[11]||(e[11]=[i(" Loading... ",-1)])]),_:1})),e[26]||(e[26]=o("",5)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-937",class:"mermaid",graph:"flowchart%20TD%0A%20%20%20%20subgraph%20Shared%20-%20Core%20Package%20internal%0A%20%20%20%20%20%20%20%20SCHEMA_GEN%5B%22ErrorResponseSchemaGenerator%22%5D%0A%20%20%20%20%20%20%20%20SCHEMA_GEN%20--%3E%20STD_SCHEMA%5B%22Standard%20JSON%20schema%3Cbr%2F%3E(code%2C%20message%2C%20fieldErrors%2C%20...)%22%5D%0A%20%20%20%20%20%20%20%20SCHEMA_GEN%20--%3E%20PD_SCHEMA%5B%22Problem%20Details%20schema%3Cbr%2F%3E(type%2C%20title%2C%20status%2C%20detail%2C%20instance)%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20ErrorLens.ErrorHandling.OpenApi%20-%20net9%2B%0A%20%20%20%20%20%20%20%20OA_EXT%5B%22AddErrorHandlingOpenApi()%22%5D%0A%20%20%20%20%20%20%20%20OA_EXT%20--%3E%20OA_TRANS%5B%22ErrorResponseOperationTransformer%3Cbr%2F%3E%3A%20IOpenApiOperationTransformer%22%5D%0A%20%20%20%20%20%20%20%20OA_TRANS%20--%3E%20SCHEMA_GEN%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20ErrorLens.ErrorHandling.Swashbuckle%20-%20net6-8%0A%20%20%20%20%20%20%20%20SW_EXT%5B%22AddErrorHandlingSwashbuckle()%22%5D%0A%20%20%20%20%20%20%20%20SW_EXT%20--%3E%20SW_FILTER%5B%22ErrorResponseOperationFilter%3Cbr%2F%3E%3A%20IOperationFilter%22%5D%0A%20%20%20%20%20%20%20%20SW_FILTER%20--%3E%20SCHEMA_GEN%0A%20%20%20%20end%0A%0A%20%20%20%20OA_TRANS%20--%3E%20OPS%5B%22Add%20error%20responses%3Cbr%2F%3Eto%20OpenAPI%20operations%22%5D%0A%20%20%20%20SW_FILTER%20--%3E%20OPS%0A%0A%20%20%20%20style%20SCHEMA_GEN%20fill%3A%232563eb%2Ccolor%3A%23fff%0A%20%20%20%20style%20OA_TRANS%20fill%3A%23059669%2Ccolor%3A%23fff%0A%20%20%20%20style%20SW_FILTER%20fill%3A%23d97706%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[12]||(e[12]=[i(" Loading... ",-1)])]),_:1})),e[27]||(e[27]=o("",4)),(r(),d(s,null,{default:t(()=>[n(a,{id:"mermaid-967",class:"mermaid",graph:"graph%20TD%0A%20%20%20%20subgraph%20Core%20Package%20Targets%0A%20%20%20%20%20%20%20%20NET6%5B%22net6.0%22%5D%0A%20%20%20%20%20%20%20%20NET7%5B%22net7.0%22%5D%0A%20%20%20%20%20%20%20%20NET8%5B%22net8.0%22%5D%0A%20%20%20%20%20%20%20%20NET9%5B%22net9.0%22%5D%0A%20%20%20%20%20%20%20%20NET10%5B%22net10.0%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20Conditional%20Compilation%0A%20%20%20%20%20%20%20%20CC1%5B%22%23if%20NET7_0_OR_GREATER%3Cbr%2F%3EIRateLimitResponseWriter%3Cbr%2F%3EDefaultRateLimitResponseWriter%22%5D%0A%20%20%20%20%20%20%20%20CC2%5B%22%23if%20NET8_0_OR_GREATER%3Cbr%2F%3EErrorHandlingExceptionHandler%3Cbr%2F%3EIExceptionHandler%20registration%22%5D%0A%20%20%20%20end%0A%0A%20%20%20%20NET6%20-.-%3E%7Cexcluded%20from%7C%20CC1%0A%20%20%20%20NET6%20-.-%3E%7Cexcluded%20from%7C%20CC2%0A%20%20%20%20NET7%20--%3E%7Cincluded%20in%7C%20CC1%0A%20%20%20%20NET7%20-.-%3E%7Cexcluded%20from%7C%20CC2%0A%20%20%20%20NET8%20--%3E%7Cincluded%20in%7C%20CC1%0A%20%20%20%20NET8%20--%3E%7Cincluded%20in%7C%20CC2%0A%0A%20%20%20%20style%20CC1%20fill%3A%23059669%2Ccolor%3A%23fff%0A%20%20%20%20style%20CC2%20fill%3A%232563eb%2Ccolor%3A%23fff%0A"})]),fallback:t(()=>[...e[13]||(e[13]=[i(" Loading... ",-1)])]),_:1})),e[28]||(e[28]=o("",31))])}const T=l(A,[["render",E]]);export{m as __pageData,T as default};
